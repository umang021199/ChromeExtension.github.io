"use strict";(self.webpackChunksfsce=self.webpackChunksfsce||[]).push([[84],{2084:(Ye,ae,A)=>{A.r(ae),A.d(ae,{ReportsModule:()=>We});var w=A(9808),D=A(1533),C=A(7555),me=A(6340),j=A(4004),N=A(5076),R=A(3444);const F=new me.XMLParser,c={debug:{test1:null},xlsx:{colstyles:{font:{color:{rgb:"ffffff"},bold:!0,name:"Consolas"},fill:{fgColor:{rgb:"81aca6"}},alignment:{vertical:"center",horizontal:"center",wrapText:!0}},colstylesL:{font:{color:{rgb:"ffe299"},bold:!0,name:"Consolas",sz:14},fill:{fgColor:{rgb:"78909c"}},alignment:{vertical:"center",horizontal:"center",wrapText:!0}},rowstyle:{fill:{fgColor:{rgb:"cccccc"}},font:{sz:10,name:"Consolas"},alignment:{vertical:"top",horizontal:"left",wrapText:!0}},rowstyle_nofill:{font:{sz:10,name:"Consolas"},alignment:{vertical:"top",horizontal:"left",wrapText:!0}}},rxp:{extract_response:e=>(0,j.U)(o=>(o=JSON.parse(JSON.stringify(o,(t,a)=>{if("attributes"!==t)return null==a?"-":a})))[e])},createChunks:(e,o)=>Array(Math.ceil(e.length/o)).fill(0).map((a,i)=>e.slice(i*o,o*(i+1))),cloneDeepLossy:e=>JSON.parse(JSON.stringify(e)),max(...e){let o=e[0];for(let t=1;t<e.length;t++)e[t]>o&&(o=e[t]);return o},clone_sort_removeObjects:(e,o)=>JSON.parse(JSON.stringify(e,o),(t,a)=>{if(0!==Object.keys(a).length)return a}),safearray:e=>e?Array.isArray(e)?e:[e]:[],safevalue:e=>null==e?{}:e,safe_str_1:"\xe2\xe7\xbd\xc1|\xfe\xb2\xcf\u02dc\xc3\u2020\u2122??\xf4\x90\xb9\xf8\xdf\xff\u0178\xd9\xb6\xc5:\xcf\u0192\xa7\u0178\xba\u2122\xd0\xc6\xb3\xd3\xcd\xaf\xaf\xb1\xf3#\xd0\u201c\xc7",create_merge(e,o,t,a){e.forEach(i=>{const r=o-t+1;o>r&&a.push({s:{r,c:i},e:{r:o,c:i}})})},flatten_readable(e){let o=!0;return Object.entries(e).forEach(([t,a])=>{Object.keys(a).length>0&&"string"!=typeof a&&(o=!1,Object.entries(a).forEach(([i,r])=>{e[`${t}_${i}`]=r}),delete e[t])}),o?e:c.flatten_readable(e)},flatten_readable2(e,o){let t={};return Object.entries(e).map(([a,i])=>{let r=o?`${o}_${a}`:a;"string"!=typeof i&&Object.keys(i).length?t=Object.assign(Object.assign({},t),c.flatten_readable2(i,r)):t[r]=e[a]}),t},getdate:()=>(new Date).toLocaleString().replace(/\//g,"-").replace(", "," ").replace(/\:/g,"-"),getuniquename:function(e,o){if(o[e]){const t=e.lastIndexOf("(");if(t<0)c.getuniquename(`${e}(1)`,o);else{const a=parseInt(1*e.slice(t+1,-1));if(isNaN(a))c.getuniquename(e+"(1)",o);else{const i=`${e.slice(0,t)}(${a+1})`;c.getuniquename(i,o)}}}else o[e]=1;return Object.keys(o).slice(-1)[0]},rotatejson:e=>e[0].map(()=>e).map((o,t)=>o.map(a=>a[t])),deepspread:e=>function o(t){return Array.isArray(t)?t.reduce((a,i)=>[...a,...Array.isArray(i)?o(i):[i]],[]):t}(e),cellnamegenerator:(e,o)=>{let t="ABCDEFGHIJKLMNOPQRSTUVWXYZA";return o.map(i=>Array(e).fill("x").map((r,n)=>(n<26?t[n]:t[Math.floor(n/26-1)]+t[n-26*Math.ceil(n/26-1)])+i)).reduce((i,r)=>[...i,...r],[])},converttoalpha:function(e){const o=["",..."ABCDEFGHIJKLMNOPQRSTUVWXYZ"],t=Math.floor((e-1)/26);return`${t<27?o[t]:c.converttoalpha(t)}${o[e-26*t]}`},cell_names:function(e,o){const t=Array(e).fill(0).map((i,r)=>r+1),a=[];return o.forEach(i=>a.push(...t.map(r=>c.converttoalpha(r)+i))),a},sortobjects:(e,o)=>e.map(t=>[t[o].toLowerCase(),t]).sort().map(t=>t[1]),mergecommoncellsvertical:(e,o,t,a,i)=>{let r=[],n=null;e.slice().map((m,g)=>[m,g]).map(m=>n==m[0]?null:(n=m[0],r.push(m)));let l=r.map((m,g)=>m[1]);r=l.map((m,g)=>({r1:m,r2:l[g+1]?l[g+1]-1:e.length-1}));let d=r.map(m=>({s:{r:m.r1+t,c:o},e:{r:m.r2+t,c:o}})),p=c.cellnamegenerator(o+1,[0]).slice(-1)[0].replace("0","");return i=i||["ffffff","fef8e3"],d.slice().map(m=>p+(m.s.r+1)).map((m,g)=>a[m]?a[m].s.fill=g%2==1?{fgColor:{rgb:i[0]}}:{fgColor:{rgb:i[1]}}:null),d},addmissingcolumns:(e,o)=>e.map(t=>Object.assign({},o.reduce((a,i)=>Object.assign(Object.assign({},a),{[i]:null!=t[i]?t[i]:""}),[]))),mergeobjarray:(e,o)=>{let t=e.reduce((i,r)=>[...i,...r],[]);return t=c.fillmissingkeysfast(t.slice()),[...new Set(t.map(i=>i[o]))].map(i=>c.mergeobjects(t.filter(r=>r[o]==i)))},mergeobjarray2:(e,o)=>{let t=e;t=c.fillmissingkeysfast(t.slice());const a=r=>o.reduce((n,l)=>r[n]+r[l]);return[...new Set(t.map(r=>a(r)))].map(r=>c.mergeobjects(t.filter(n=>a(n)==r)))},resetcols:(e,o)=>e,mergeobjects:e=>{let o=Object.keys(e[0]);return e.reduce((t,a,i)=>o.map(r=>(a[r]=e[i>0&&""==a[r]?i-1:i][r],a))[0])},fillmissingkeys:e=>{let o=[...new Set(e.map(t=>Object.keys(t)).reduce((t,a)=>[...t,...a],[]))];return e.map(t=>(o.filter(a=>!Object.keys(t).includes(a)||null==t[a]).map(a=>{t[a]=""}),t))},fillmissingkeysfast:e=>{let o=e.map(a=>Object.keys(a)).reduce((a,i)=>[...a,...i.filter(r=>!a.includes(r))],[]),t=[...new Set(o)];return e.map(a=>(t.filter(i=>!Object.keys(a).includes(i)||null==a[i]).map(i=>{a[i]=""}),a))},executewithinterval:(...e)=>{e.map((o,t)=>setTimeout(()=>{o[1]=o[1]?o[1]:[],o[0](...o[1])},100*t))},parse:e=>c.deepspread(e.map(o=>F.parse(o)["soapenv:Envelope"]["soapenv:Body"].readMetadataResponse.result.records)),renameduplicates:e=>{let o=[],t=[];return e.map(a=>{o.includes(a.name)?t.push(a.name):o.push(a.name)}),e.map(a=>{t.includes(a.name)&&(a.name=a.name+` (${a.id})`)}),e}},S={builder:e=>{e=R.o.map(n=>n.info);const o=[];R.o.forEach(n=>{["permissionset","profile"].forEach(l=>{n[l+"_metadata"].forEach(d=>{o.push(...c.safearray(F.parse(d)["soapenv:Envelope"]["soapenv:Body"].readMetadataResponse.result.records).filter(p=>p).map(p=>{p.org=n.name,p.metadata_type=l,p.full=n;const m=n[l+"s"].filter(g=>g.apiname==p.fullName)[0]||{};return p.id=m.id,p.name=m.name,p}))})})});const t={};R.o.forEach(n=>{[...n.permissionsets,...n.profiles].forEach(d=>{t[d.id]=d.name})});const a={};R.o.forEach(n=>{[...n.permissionsets,...n.profiles].forEach(d=>a[d.apiname]=d.name)});const i=[{name:"Basic",data:S.keymapper.Basic(e,t)},{name:"General Permissions",data:S.keymapper["General Permissions"](o,a)},{name:"Apex Classes",data:S.keymapper["Apex Classes"](o,a)},{name:"Visualforce",data:S.keymapper.Visualforce(o,a)}],r=S.parse(i);return S.createsheet(r)},keymapper:{Basic:(e,o)=>{const a=[];return e.forEach((i,r)=>{i.forEach(n=>{if(o[n.Profile?n.ProfileId:n.Id]){const d=((i,r)=>{var n,l;return{Name:i.Name,Org:r,"API Name":i.Name,Label:i.Label,Description:i.Description||"",Id:i.Profile?i.ProfileId:i.Id,License:i.License?i.License.Name:"none","Activation Required":null===(n=i.HasActivationRequired)||void 0===n?void 0:n.toString(),"Is Custom":null===(l=i.IsCustom)||void 0===l?void 0:l.toString(),"Created Date":i.CreatedDate,"Last Modified Date":i.LastModifiedDate}})(n,R.o[r].name);a.push(d)}})}),a.sort((i,r)=>i.Name<r.Name?-1:1),a},"General Permissions":(e,o)=>{let t=[];e.forEach(i=>{c.safearray(i.userPermissions).forEach(r=>{t.push({Field:r.name,Org:i.org,[i.fullName]:r.enabled})})});const a=["Field","Org"];return t=c.mergeobjarray2(t,a),t=c.resetcols(t,a[0]),t=c.sortobjects(t,a[0]),t},"Apex Classes":(e,o)=>{let t=[];e.forEach(i=>{c.safearray(i.classAccesses).forEach(r=>{t.push({ApexClassName:r.apexClass,Org:i.org,[i.fullName]:r.enabled})})});const a=["ApexClassName","Org"];return t=c.mergeobjarray2(t,a),t=c.resetcols(t,a[0]),t=c.sortobjects(t,a[0]),t},Visualforce:(e,o)=>{let t=[];e.forEach(i=>{c.safearray(i.pageAccesses).forEach(r=>{t.push({PageName:r.apexPage,Org:i.org,[i.fullName]:r.enabled})})});const a=["PageName","Org"];return t=c.mergeobjarray2(t,a),t=c.resetcols(t,a[0]),t=c.sortobjects(t,a[0]),t}},stylemapper:{Basic:(e,o)=>{const t=Object.keys(e[0]||{}),a=t.map(i=>Math.max(i.length,...e.slice(0,100).map(r=>`${r[i]}`.length)));o["!cols"]=a.map(i=>({wch:i>40?44:i+4})),o["!rows"]=[{hpt:30}],c.cell_names(t.length,[1]).forEach(i=>{o[i].s=c.xlsx.colstyles}),c.cell_names(t.length,e.map((i,r)=>r+2).filter((i,r)=>r%2)).forEach(i=>o[i].s=c.xlsx.rowstyle),c.cell_names(t.length,e.map((i,r)=>r+2).filter((i,r)=>r%2==0)).forEach(i=>o[i].s=c.xlsx.rowstyle_nofill)},"General Permissions":()=>{}},parse:function(e){return e},createsheet:e=>{const o=N.utils.book_new();return e.forEach(t=>{const a=N.utils.json_to_sheet(t.data);S.stylemapper.Basic(t.data,a),N.utils.book_append_sheet(o,a,t.name)}),o}},q={steps:{parseresponsetojson({profile_metadata:e,permissionset_metadata:o,profiles:t,permissionsets:a}){const i=c.parse(e).filter(n=>n),r=c.parse(o).filter(n=>n);return i.forEach(n=>{let l=t.filter(d=>d.apiname==n.fullName)[0];n.id=l.id}),r.forEach(n=>{let l=a.filter(d=>d.apiname==n.fullName)[0];n.id=l.id}),{profile_metadata:i,permissionset_metadata:r}},getworksheetdata(e,o,t,a,i){const r=[...o.permissionset_metadata,...o.profile_metadata],n=o.profile_metadata,l={};return r.forEach(d=>l[d.id]=d.label),e.forEach(d=>{const p={};[].concat(d.permissionsets,d.profiles).forEach(m=>p[m.id]=m.name),d.idtolabel=p}),{basic:M.basic(e,t,l),fieldlevelsecurity:M.fieldlevelsecurity(r,l,t,a,i),generalpermissions:M.generalpermissions(r,l,t,i),apexclasses:M.apexclasses(r,t,l,i),layoutassignment:M.layoutassignment(n,t,a,i),objectaccess:M.objectaccess(r,t,a,l,i),pageaccessvisualforce:M.pageaccessvisualforce(r,t,l,i),recordtype:M.recordtype(r,t,a,l,i),tabvisibilities:M.tabvisibilities(r,t)}},createsheet(e,o,t){const a=N.utils.book_new();return e.filter(i=>i.data&&i.data.length>0).map(i=>{let r=c.fillmissingkeys(i.data),n=i.name.includes("Field")&&r.unshift(Object.keys(r[0]).reduce((u,y)=>Object.assign(Object.assign({},u),{[y]:y}),[]));const l=N.utils.json_to_sheet(r);switch(c.cellnamegenerator(Object.keys(r[0]).length,[1,...r.map((u,y)=>y+2)]).map(u=>{let y={alignment:{vertical:"top",horizontal:"left",wrapText:!0},font:c.xlsx.rowstyle.font};u.match(/\d+/)[0]%2==1&&(y.fill={fgColor:{rgb:"cccccc"}}),l[u]&&(l[u].s=y)}),i.name){case"Object Access":case"Layout Assignments":l["!merges"]=c.mergecommoncellsvertical(r.slice().map(u=>u.Object),0,1,l);break;case"Record Types":l["!merges"]=[...c.mergecommoncellsvertical(r.slice().map(u=>u.Object),0,1,l),...c.mergecommoncellsvertical(r.slice().map(u=>u["Record Type"]),1,1,l,["ffffff","e3f3d6"])]}if(n){let u=c.mergecommoncellsvertical(r.slice(1).map(_=>_.SObjectType),0,2,l),y=[{s:{r:0,c:0},e:{r:1,c:0}},{s:{r:0,c:1},e:{r:1,c:1}},...Object.keys(r[0]).map((_,h)=>h%2==0&&h>1&&{s:{r:0,c:h},e:{r:0,c:h+1}}).filter(_=>0!=_),...u];l["!merges"]=y,c.cellnamegenerator(Object.keys(r[0]).length,[1]).map((_,h)=>{h>1&&h%2==0&&(l[_].v=l[_].v.split("%")[0])}),c.cellnamegenerator(Object.keys(r[0]).length,[2]).map((_,h)=>{h>1&&(l[_].v=l[_].v.split("%").slice(-1)[0])})}const p=o.map(u=>u.id),m=t.map(u=>u.id),g=[];[...o,...t].forEach(u=>g[u.id]=u.name),c.cellnamegenerator(Object.keys(r[0]).length,n?[1,2]:[1]).map(u=>{let y=Object.assign({},l[u].s);y.alignment={vertical:"center",horizontal:"center",wrapText:!0},y.font={color:{rgb:"1"==u.match(/\d+/)[0]?"ffffff":"ffe299"},bold:!0,sz:11,name:"Consolas"},y.fill={fgColor:{rgb:p.includes(l[u].v)?"729fcf":m.includes(l[u].v)?"81aca6":"78909c"}},l[u].s=y,g[l[u].v]&&(l[u].v=g[l[u].v])});let b=Object.keys(r[0]).map((u,y)=>({wch:n&&y>1?20:Math.max((g[u]?g[u]:u).length,...r.map(_=>_[u]).map(_=>_?_.toString().length>30?30:_.toString().length:4))+1}));l["!cols"]=b,l["!rows"]=[{hpt:30}],N.utils.book_append_sheet(a,l,i.name)}),a},sheetdatamapper:e=>[{name:"Basics",data:e.basic},{name:"General Permissions",data:e.generalpermissions},{name:"Field Level Security",data:e.fieldlevelsecurity},{name:"Apex Classes",data:e.apexclasses},{name:"Visualforce",data:e.pageaccessvisualforce},{name:"Tab Visibilities",data:e.tabvisibilities},{name:"Object Access",data:e.objectaccess},{name:"Record Types",data:e.recordtype},{name:"Layout Assignments",data:e.layoutassignment}]},builder(e){const{permissionsets:i,profiles:r}=e[0],n=q.steps.parseresponsetojson(e[0]),l=q.steps.getworksheetdata(e,n,c.mergeobjarray,c.sortobjects,c.addmissingcolumns),d=q.steps.sheetdatamapper(l);return q.steps.createsheet(d,r,i)}},M={basic:function(e,o,t){let a=[];const i=e[0],r=[...Object.keys(i.idtolabel)];return i.info.filter(l=>r.includes(l.Profile?l.ProfileId:l.Id)).forEach(l=>{let d={Id:l.Profile?l.ProfileId:l.Id,Name:l.Name,"API Name":l.Name,Label:l.Label,Description:l.Description,License:l.License?l.License.Name:"none","Activation Required":l.HasActivationRequired.toString(),"Is Custom":l.IsCustom.toString(),"Created Date":l.CreatedDate,"Last Modified Date":l.LastModifiedDate};const p=Object.entries(d).map(m=>({Property:m[0],[i.idtolabel[d.Id]]:m[1]}));a.push(p)}),o(a,"Property")},fieldlevelsecurity:function(e,o,t,a,i){let n=[...e.map(p=>(p.fieldPermissions?p.fieldPermissions:[]).map(m=>(m.id=p.id,m)))].map(p=>p.map(m=>({Field:m.field,[[m.id]+"%Read"]:m.readable,[[m.id]+"%Write"]:m.editable})));return n=a(t(n,"Field"),"Field").map(p=>{let m=p.Field.split(".");return p.Field=m.length>1?m[1]:p.Field,Object.assign({SObjectType:m.length>0?m[0]:p.Field},p)}),i(n,["SObjectType","Field",...Object.keys(o).reduce((p,m)=>[...p,m+"%Read",m+"%Write"],[])])},generalpermissions:function(e,o,t,a){return a(t(e.filter(p=>p.userPermissions).map(p=>(p.userPermissions.name?[p.userPermissions]:p.userPermissions).map(m=>({Name:m.name,[p.id]:m.enabled}))),"Name"),["Name",...Object.keys(o)])},apexclasses:(e,o,t,a)=>a(o(e.filter(d=>d.classAccesses).map(d=>(d.classAccesses.apexClass?[d.classAccesses]:d.classAccesses).map(p=>({ApexClassName:p.apexClass,[d.id]:p.enabled}))),"ApexClassName"),["ApexClassName",...Object.keys(t)]),pageaccessvisualforce:(e,o,t,a)=>a(o(e.filter(d=>d.pageAccesses).map(d=>(d.pageAccesses.apexPage?[d.pageAccesses]:d.pageAccesses).map(p=>({PageName:p.apexPage,[d.id]:p.enabled}))),"PageName"),["PageName",...Object.keys(t)]),tabvisibilities:(e,o)=>o(e.map(a=>(a.tabvisibilities?a.tabVisibilities:[]).map(i=>({TabName:i.tab,[a.id]:i.visibility}))),"TabName"),objectaccess:(e,o,t,a,i)=>{let n=o(e.filter(m=>null!=m.objectPermissions).map(m=>(m.objectPermissions.object?[m.objectPermissions]:m.objectPermissions).map(g=>Object.keys(g).filter(b=>"object"!=b).map(b=>({Object:g.object+"%"+b,[m.id]:g[b]})))).reduce((m,g)=>[...m,...g],[]),"Object");n=t(n,"Object"),n=n.map(m=>{let g=m.Object.split("%");return delete m.Object,Object.assign({Object:g[0],"Access Level":g[1]},m)});let l={allowCreate:"Create",allowDelete:"Delete",allowEdit:"Edit",allowRead:"Read",modifyAllRecords:"Modify All",viewAllRecords:"View All"};return n=n.map(m=>(m["Access Level"]=l[m["Access Level"]],m)),i(n,["Object","Access Level",...Object.keys(a)])},recordtype:(e,o,t,a,i)=>{let n=o(e.filter(p=>p.recordTypeVisibilities).map(p=>(p.recordTypeVisibilities.recordType?[p.recordTypeVisibilities]:p.recordTypeVisibilities).map(m=>Object.keys(m).filter(g=>"recordType"!=g).map(g=>({RecordType:m.recordType+"%"+g,[p.id]:m[g]})))).reduce((p,m)=>[...p,...m],[]),"RecordType");return n=n.map(p=>{let m=p.RecordType.split("%");return delete p.RecordType,Object.assign({Object:m[0].split(".")[0],"Record Type":m[0].split(".")[1],Permission:m[1]},p)}),n=t(n,"Object"),i(n,["Object","Record Type","Permission",...Object.keys(a)])},layoutassignment:(e,o,t,a)=>{let i="layoutAssignments",l=o(e.filter(m=>m[i]).map(m=>(m[i].layout?[m[i]]:m[i]).map(g=>Object.keys(g).map(b=>({RecordType:g.recordType?g.recordType:g.layout.split("-")[0]+".Master",[m.id]:g.layout.split("-").slice(-1)[0]})))).reduce((m,g)=>[...m,...g],[]),"RecordType");return l=l.map(m=>{let g=m.RecordType;return delete m.RecordType,Object.assign({Object:g.split(".")[0],RecordType:g.split(".")[1]},m)}),l=t(l,"Object"),a(l,["Object","RecordType",...e.map(m=>m.id)])}};var k=A(520),E=A(4128),U=A(9646),O=A(4999),s=A(5e3);let oe=(()=>{class e{constructor(t){this.http=t}getSObjects(){let t=new k.WM;return t=t.set("cache","SObjects_approvalProcess"),t=t.set("background",["true"]),this.http.get(O.I8.instanceUrl+`/services/data/v${C.X.data.salesforce.api.version}/query/?q=SELECT Id, Name, DeveloperName, TableEnumOrId, State, Description from ProcessDefinition`,{headers:t}).pipe((0,j.U)(a=>a.records))}getdatasoap({type:t,fullnames:a}){const i=`<?xml version="1.0" encoding="utf-8"?>\n    <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:tns="http://soap.sforce.com/2006/04/metadata" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">\n        <soapenv:Header>\n            <tns:SessionHeader>\n                <tns:sessionId>${O.I8.sessiontoken}</tns:sessionId>\n            </tns:SessionHeader>\n        </soapenv:Header>\n        <soapenv:Body>\n            <tns:readMetadata xmlns="http://soap.sforce.com/2006/04/metadata">\n                <tns:type>__type__</tns:type>\n                <tns:fullNames>_fullName_</tns:fullNames> \n            </tns:readMetadata>\n        </soapenv:Body>\n    </soapenv:Envelope>`;let r=a.slice(),d=Array(Math.ceil(r.length/10)).fill(0).map((p,m)=>r.slice(10*m,10*(m+1))).map(p=>i.replace("<tns:fullNames>_fullName_</tns:fullNames>",p.map(m=>"<tns:fullNames>"+m+"</tns:fullNames>").join("\n")).replace("__type__",t));return d.length>0?(0,E.D)(d.map((p,m)=>this.postsoap(p,"approval_process_soap_"+m))).pipe((0,j.U)(p=>p.map(m=>m.body))):(0,U.of)([])}postsoap(t,a){let i=O.I8.instanceUrl+"/services/Soap/m/50.0",r=new k.WM;return r=r.set("background",["true"]),this.http.post(i,t,{responseType:"text",observe:"response",headers:r})}}return e.\u0275fac=function(t){return new(t||e)(s.LFG(k.eN))},e.\u0275prov=s.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var re=A(9643),de=A(1135),ue=A(9468),B=A(3075);let V=(()=>{class e{constructor(){this.export=new s.vpe,this.click_observable=new de.X(null)}ngOnInit(){this.click_observable.pipe((0,ue.p)(1e3)).subscribe(t=>{t&&this.export.emit(this.name)})}onExport(){this.click_observable.next(1)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Xpm({type:e,selectors:[["v-file-export"]],inputs:{name:"name",can:"can"},outputs:{export:"export"},decls:7,vars:5,consts:[[1,"input-group","w-100","px-1"],[3,"click"],[1,"bi","bi-file-earmark-excel"],[1,"input-group-text"],["type","text","id","inputbox","aria-describedby","basic-addon3",1,"form-control",3,"ngModel","ngModelChange"]],template:function(t,a){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s.NdJ("click",function(){return a.onExport()}),s._UZ(2,"i",2),s._uU(3," Export Excel "),s.qZA(),s.TgZ(4,"span",3),s._uU(5),s.qZA(),s.TgZ(6,"input",4),s.NdJ("ngModelChange",function(r){return a.name=r}),s.qZA(),s.qZA()),2&t&&(s.xp6(1),s.Gre("btn z-0 ",a.can?"btn-success":"btn-light pe-none",""),s.xp6(4),s.hij("",a.name||"Untitled",".xlsx "),s.xp6(1),s.Q6J("ngModel",a.name))},directives:[B.Fj,B.JJ,B.On],styles:[""]}),e})();var $=A(4702);function fe(e,o){1&e&&(s.TgZ(0,"div",8),s._uU(1," This Salesforce org has no Approval Process. please create some in order to use this feature. "),s.qZA())}function he(e,o){if(1&e){const t=s.EpF();s.TgZ(0,"div",9),s.TgZ(1,"button",10),s._uU(2),s.qZA(),s.TgZ(3,"div",11),s.TgZ(4,"app-multiselect",12),s.NdJ("selectionChange",function(i){return s.CHM(t),s.oxw().UI.sobjects.selection=i}),s.qZA(),s.qZA(),s.qZA()}if(2&e){const t=s.oxw();s.xp6(2),s.hij(" Select ",t.UI.sobjects.selection.length," "),s.xp6(2),s.Q6J("allunique",t.UI.sobjects.all)("selection",t.UI.sobjects.selection)}}function ge(e,o){if(1&e){const t=s.EpF();s.TgZ(0,"button",13),s.NdJ("click",function(){const r=s.CHM(t).$implicit;return s.oxw().UI.sobjects.toggle(r)}),s._uU(1),s.qZA()}if(2&e){const t=o.$implicit;s.xp6(1),s.hij(" ",t.name," ")}}let ve=(()=>{class e{constructor(t){this.service=t,this.main={fetchdata:a=>{const i=this.service.getdatasoap({type:"ApprovalProcess",fullnames:this.UI.sobjects.selection.map(r=>r.id)});C.X.operation.tasks.worker.create(i,"approval_process",a).subscribe(r=>{N.writeFile(r,(a||"untitled")+".xlsx"),C.X.operation.support.update_count({report:!0})})}},this.UI={export:a=>{this.main.fetchdata(a)},types:{"Approval Process":"Approval Process"},sobjects:{selection:[],all:[],toggle:a=>{this.UI.sobjects.selection.splice(this.UI.sobjects.selection.indexOf(a),1)}}}}ngOnInit(){this.service.getSObjects().subscribe(a=>{a.forEach(i=>{this.UI.sobjects.all.push({id:i.TableEnumOrId+"."+i.DeveloperName,name:i.Name})})})}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(oe))},e.\u0275cmp=s.Xpm({type:e,selectors:[["app-approval-process"]],decls:10,vars:4,consts:[[1,"h-100-80","overflow-auto","rounded","p-2"],[1,"rounded","bg-light","p-2"],["warning",""],["class","d-flex justify-content-between","id","selectbtn",4,"ngIf","ngIfElse"],[1,"bg-light","rounded","w-100"],["class","btn btn-success badge me-1",3,"click",4,"ngFor","ngForOf"],["name","Approval Process Report",3,"can","export"],[1,"rounded","w-100","d-flex-child","overflow-auto"],[1,"w-100","text-small","text-center","text-danger","ignoretheme"],["id","selectbtn",1,"d-flex","justify-content-between"],["data-bs-toggle","dropdown",1,"btn","btn-primary","btn-sm","w-100","dropdown-toggle"],[1,"dropdown-menu","w-100","bg-transparent","p-0","px-4","border-0"],[1,"theme-light",3,"allunique","selection","selectionChange"],[1,"btn","btn-success","badge","me-1",3,"click"]],template:function(t,a){if(1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s.YNc(2,fe,2,0,"ng-template",null,2,s.W1O),s.YNc(4,he,5,3,"div",3),s.TgZ(5,"div",4),s.YNc(6,ge,2,1,"button",5),s.qZA(),s.qZA(),s.qZA(),s.TgZ(7,"v-file-export",6),s.NdJ("export",function(r){return a.UI.export(r)}),s.qZA(),s.TgZ(8,"div",7),s._UZ(9,"v-process-holder"),s.qZA()),2&t){const i=s.MAs(3);s.xp6(4),s.Q6J("ngIf",a.UI.sobjects.all.length>0)("ngIfElse",i),s.xp6(2),s.Q6J("ngForOf",a.UI.sobjects.selection),s.xp6(1),s.Q6J("can",a.UI.sobjects.selection.length>0)}},directives:[w.O5,re.z,w.sg,V,$.G],styles:[""]}),e})();var ye=A(6921),ne=A(2463),le=A(5577),be=A(262),xe=A(4782);let _e=(()=>{class e{constructor(t,a,i){this.http=t,this.httpx=a,this.backend=i,this.main={get_permissions_multi:r=>(0,E.D)(r.map(n=>this.main.get_permissions({profiles:n.profile.selection,permissionsets:n.permissionset.selection,org:n}))),get_permissions:({profiles:r,permissionsets:n,org:l})=>{const d=r.map(b=>b.id),p=n.map(b=>b.apiname),m=c.cloneDeepLossy(r),g=c.cloneDeepLossy(n);return(0,E.D)([this.main.getprofileapinames(d,l).pipe((0,le.z)(b=>(b.forEach((u,y)=>{m[y].apiname=u}),this.main.getdatasoap(b,"Profile",l)))),this.main.getdatasoap(p,"PermissionSet",l)]).pipe((0,j.U)(b=>({profile_metadata:b[0]||[],permissionset_metadata:b[1]||[],profiles:m,permissionsets:g,info:l.info,name:l.name})))},getbasicdata:r=>(0,E.D)(r.map(l=>this.utility.executequery("SELECT IsCustom, License.Name , Label , Description , CreatedDate , LastModifiedDate, HasActivationRequired , Id , ProfileId , Profile.Name , Name , NamespacePrefix FROM PermissionSet",l).pipe((0,j.U)(d=>d.records),(0,be.K)(d=>(0,U.of)([]))))),getbasicforall(){return(0,E.D)(Object.values(C.X.data.salesforce.user.all).map(r=>this.getbasicdata(r)))},getprofileapinames:(r,n)=>{let d=r.map(p=>"select id, name, fullName from Profile Where Id = 'placeholder' limit 1".replace("placeholder",p));return d.length>0?(0,E.D)(d.map(p=>this.utility.executequerytoolingapi(p,n))).pipe((0,j.U)(p=>p.map(m=>m.records[0].FullName))):(0,U.of)([])},getdatasoap:(r,n,l)=>{let d=r.slice(),g=Array(Math.ceil(d.length/10)).fill(0).map((b,u)=>d.slice(10*u,10*(u+1))).map(b=>'<?xml version="1.0" encoding="utf-8"?>\n      <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:tns="http://soap.sforce.com/2006/04/metadata">\n          <soapenv:Header>\n              <tns:SessionHeader>\n                  <tns:sessionId>'+l.token+'</tns:sessionId>\n              </tns:SessionHeader>\n          </soapenv:Header>\n          <soapenv:Body>\n          <tns:readMetadata xmlns="http://soap.sforce.com/2006/04/metadata"><tns:type>'+n+"</tns:type>"+b.map(u=>"<tns:fullNames>"+u+"</tns:fullNames>").join("\n")+"</tns:readMetadata> \n          </soapenv:Body>\n      </soapenv:Envelope>");return g.length>0?(0,E.D)(g.map(b=>this.utility.postsoap(b,l.url))).pipe((0,j.U)(b=>b.map(u=>u.body))):(0,U.of)([])}},this.utility={executequery:(r,n)=>{const l=n.url+"/services/data/v53.0/query/?q="+r,d=this.utility.headerx(n.token);return this.httpx.get(l,{headers:d})},fullnames:{},executequerytoolingapi:(r,n)=>{let l=n.url+"/services/data/v53.0/tooling/query/?q="+r;if(!this.utility.fullnames[r]){let d=new k.WM;d=this.utility.headerx(n.token),this.utility.fullnames[r]=this.httpx.get(l,{headers:d}).pipe((0,xe.d)(1))}return this.utility.fullnames[r]},postsoap:(r,n)=>this.http.post(n+"/services/Soap/m/50.0",r,{responseType:"text",observe:"response"}),headerx:r=>{let n=new k.WM;return n=n.set("Api-User-Agent","Example/1.0"),n=n.set("Authorization",`Bearer ${r}`),n=n.set("Accept","application/json"),n=n.set("content-type","application/json"),n}},this.httpx=new k.eN(i)}}return e.\u0275fac=function(t){return new(t||e)(s.LFG(k.eN),s.LFG(k.eN),s.LFG(k.jN))},e.\u0275prov=s.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Ae=A(8843);function Ce(e,o){1&e&&s.GkF(0)}function Pe(e,o){1&e&&s.GkF(0)}const Ne=function(e){return{active:e}};function Te(e,o){if(1&e){const t=s.EpF();s.TgZ(0,"div",13),s.NdJ("click",function(){const r=s.CHM(t).$implicit;return s.oxw(2).nav.gototab(r)}),s._uU(1),s.qZA()}if(2&e){const t=o.$implicit,a=s.oxw(2);s.Q6J("ngClass",s.VKq(2,Ne,t==a.nav.active)),s.xp6(1),s.hij(" ",a.nav.title[t]," ")}}const ke=function(){return[]};function Ie(e,o){if(1&e&&s.YNc(0,Te,2,4,"div",12),2&e){const t=s.oxw();s.Q6J("ngForOf",s.DdM(1,ke)||t.nav.links)}}function Ee(e,o){1&e&&(s.TgZ(0,"span",20),s._uU(1," session expired "),s.qZA())}function je(e,o){if(1&e&&(s.TgZ(0,"div",18),s.YNc(1,Ee,2,0,"span",19),s.qZA()),2&e){const t=s.oxw().$implicit;s.xp6(1),s.Q6J("ngIf",!t.permissionset.all.length)}}function Oe(e,o){if(1&e){const t=s.EpF();s.TgZ(0,"button",28),s.NdJ("click",function(){const r=s.CHM(t).$implicit,n=s.oxw(2).$implicit;return s.oxw(2).main.selector.toggle(n.permissionset.selection,r)}),s._uU(1),s.qZA()}if(2&e){const t=o.$implicit;s.xp6(1),s.hij(" ",t.name," ")}}function Le(e,o){if(1&e){const t=s.EpF();s.TgZ(0,"div",21),s.TgZ(1,"div",22),s.TgZ(2,"button",23),s._uU(3),s.qZA(),s.TgZ(4,"div",24),s.TgZ(5,"app-multiselect",25),s.NdJ("selectionChange",function(i){return s.CHM(t),s.oxw().$implicit.permissionset.selection=i}),s.qZA(),s.qZA(),s.qZA(),s.TgZ(6,"div",26),s.YNc(7,Oe,2,1,"button",27),s.qZA(),s.qZA()}if(2&e){const t=s.oxw().$implicit;s.xp6(3),s.hij(" Select PermissionSets ",t.permissionset.all.length," "),s.xp6(2),s.Q6J("allunique",t.permissionset.all)("selection",t.permissionset.selection),s.xp6(2),s.Q6J("ngForOf",t.permissionset.selection)}}function we(e,o){if(1&e){const t=s.EpF();s.TgZ(0,"button",28),s.NdJ("click",function(){const r=s.CHM(t).$implicit,n=s.oxw(2).$implicit;return s.oxw(2).main.selector.toggle(n.profile.selection,r)}),s._uU(1),s.qZA()}if(2&e){const t=o.$implicit;s.xp6(1),s.hij(" ",t.name," ")}}function Ue(e,o){if(1&e){const t=s.EpF();s.TgZ(0,"div",21),s.TgZ(1,"div",22),s.TgZ(2,"button",23),s._uU(3),s.qZA(),s.TgZ(4,"div",24),s.TgZ(5,"app-multiselect",25),s.NdJ("selectionChange",function(i){return s.CHM(t),s.oxw().$implicit.profile.selection=i}),s.qZA(),s.qZA(),s.qZA(),s.TgZ(6,"div",26),s.YNc(7,we,2,1,"button",27),s.qZA(),s.qZA()}if(2&e){const t=s.oxw().$implicit;s.xp6(3),s.hij(" Select Profiles ",t.profile.all.length," "),s.xp6(2),s.Q6J("allunique",t.profile.all)("selection",t.profile.selection),s.xp6(2),s.Q6J("ngForOf",t.profile.selection)}}function Me(e,o){if(1&e&&(s.TgZ(0,"div",15),s.YNc(1,je,2,1,"div",16),s.YNc(2,Le,8,4,"div",17),s.YNc(3,Ue,8,4,"div",17),s.qZA()),2&e){const t=o.$implicit;s.xp6(1),s.Q6J("ngIf",t.permissionset),s.xp6(1),s.Q6J("ngIf",null==t.permissionset?null:t.permissionset.all.length),s.xp6(1),s.Q6J("ngIf",null==t.profile?null:t.profile.all.length)}}function Se(e,o){if(1&e&&s.YNc(0,Me,4,3,"div",14),2&e){const t=s.oxw();s.Q6J("ngForOf",t.main.UI.multiorg?t.main.UI.orgs:t.main.UI.org)}}const ce=function(e){return{hide:e}};let De=(()=>{class e{constructor(t){this.service=t,this.shared=q,this.main={UI:{org:[C.X.data.salesforce.user.all[C.X.data.salesforce.user.active]],orgs:[],multiorg:!1,multiorgchange:()=>{const i=(this.main.UI.multiorg?Object.values(C.X.data.salesforce.user.all):[C.X.data.salesforce.user.all[C.X.data.salesforce.user.active]]).map(r=>({url:r.instanceUrl,token:r.userSessionToken,name:r.salesforcePodName}));this.main.server.reload_profile_permissionsets(i)},addorg:()=>{},parseprofilepermissionset:a=>{let i=c.sortobjects(a.filter(n=>null!=n.Profile).map(n=>({name:n.Profile.Name,id:n.ProfileId})),"name"),r=c.sortobjects(a.filter(n=>null==n.Profile).map(n=>({name:n.Name,id:n.Id,apiname:n.NamespacePrefix?n.NamespacePrefix+"__"+n.Name:n.Name})),"name");return c.renameduplicates(r),c.renameduplicates(i),this.main.status.updatestatus(),this.history.load(),{profile:i,permissionset:r,info:a}}},server:{reload_profile_permissionsets:a=>{this.main.subscriptions.add(this.service.main.getbasicdata(a).subscribe(i=>{i.forEach((r,n)=>{const l=this.main.UI.parseprofilepermissionset(r);a[n].profile={all:l.profile,selection:[]},a[n].permissionset={all:l.permissionset,selection:[]},a[n].info=l.info}),this.main.UI[this.main.UI.multiorg?"orgs":"org"]=a}))}},data:{profile:[],permissionsset:[],basic:[]},subscriptions:new ye.w0,selector:{permissionsetvalue:[],profilevalue:[],mapper:{profile:[],permissionsset:[],idtolabel:[]},toggle:(a,i)=>{a.splice(a.indexOf(i),1)}},status:{ready:!1,statusinfo:null,updatestatus:a=>{this.main.status.statusinfo=a}},info:{ids:{permissionset:[],profile:[]},description:{Profile:[],PermissionSet:[]}},export:a=>{C.X.operation.support.update_count({report:!0});const i=(this.main.UI.multiorg?this.main.UI.orgs:this.main.UI.org).filter(n=>n.profile.all.length+n.permissionset.all.length>0),r=this.service.main.get_permissions_multi(i);C.X.operation.tasks.worker.create(r,"compare_profile_permissionset",a).subscribe(n=>{this.main.buildexcel(n)})},buildexcel:a=>{try{N.writeFile(a,(a.filename?a.filename:"Untitled")+".xlsx")}catch(i){ne.y.maketoast({template:"error",body:"Oops ! Error occured, Select something to do Export",duration:5e3})}}},this.history={record:()=>{let a=`Compared Profiles ( ${this.main.selector.profilevalue.map(i=>i.name)} ), and Permission Sets ( ${this.main.selector.permissionsetvalue.map(i=>i.name)} )`;C.X.operation.history.add(a,"compare")},load:()=>{const{datatemp:{history:{selected:a}}}=C.X;a&&"compare"==a.context&&(this.history.select(a),C.X.datatemp.history.selected={history:null,context:null},ne.y.maketoast({template:"Success",body:"Restored from history"}))},select:a=>{this.nav.active="compare";let i=a.history.split("), and Permission Sets ("),r=i[0].replace("Compared Profiles ( ","").replace(/\, /g,",").split(",").map(l=>l.trim()),n=i[1].slice(0,-1).replace(/\, /g,",").split(",").map(l=>l.trim());this.main.selector.profilevalue=this.main.selector.mapper.profile.filter(l=>r.includes(l.name)),this.main.selector.permissionsetvalue=this.main.selector.mapper.permissionsset.filter(l=>n.includes(l.name)),C.X.datatemp.history.selected={history:null,context:null},setTimeout(()=>{},1e3)}},this.nav={title:{compare:"Compare",history:"History"},state:{compare:!0,history:!1},links:["compare","history"],icon:{compare:"bi bi-intersect",history:"bi bi-clock"},active:"compare",compare:"compare",gototab:a=>{this.nav.active=a}}}ngOnInit(){C.X.datatemp.history.selected&&this.main.status.updatestatus("Initializing"),this.main.UI.multiorgchange()}testexport(){const t=S.builder("abc");this.main.buildexcel(t)}ngOnDestroy(){this.main.subscriptions.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(_e))},e.\u0275cmp=s.Xpm({type:e,selectors:[["app-compare-profile-permissionset"]],decls:16,vars:9,consts:[[1,"h-100-80"],[1,"h-100-40","p-2",3,"ngClass"],[1,"h-100","overflow-auto","rounded","mb-2"],[4,"ngTemplateOutlet"],[1,"h-100-40",3,"ngClass"],["context","compare",3,"select"],["id","navbar",1,"nav-container","rounded"],["footercontainer",""],["navbar",""],["body",""],["name","Profile and Permission Sets",3,"can","export"],[1,"rounded","w-100","d-flex-child","overflow-auto"],[3,"ngClass","click",4,"ngFor","ngForOf"],[3,"ngClass","click"],["class","bg-light my-2",4,"ngFor","ngForOf"],[1,"bg-light","my-2"],["class","px-2 text-small text-secondary",4,"ngIf"],["class","rounded bg-light p-2",4,"ngIf"],[1,"px-2","text-small","text-secondary"],["class","text-danger ignoretheme",4,"ngIf"],[1,"text-danger","ignoretheme"],[1,"rounded","bg-light","p-2"],["id","selectpermissionsetsbtn",1,"d-flex","justify-content-between"],["data-bs-toggle","dropdown",1,"btn","btn-primary","btn-sm","w-100","dropdown-toggle"],[1,"dropdown-menu","w-100","bg-transparent","p-0","px-4","border-0"],[1,"theme-light",3,"allunique","selection","selectionChange"],[1,"bg-light","rounded","w-100"],["class","btn btn-success badge me-1",3,"click",4,"ngFor","ngForOf"],[1,"btn","btn-success","badge","me-1",3,"click"]],template:function(t,a){if(1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s.TgZ(2,"div",2),s.YNc(3,Ce,1,0,"ng-container",3),s.qZA(),s.qZA(),s.TgZ(4,"div",4),s.TgZ(5,"app-history-grid",5),s.NdJ("select",function(r){return a.history.select(r)}),s.qZA(),s.qZA(),s.TgZ(6,"div",6,7),s.YNc(8,Pe,1,0,"ng-container",3),s.qZA(),s.qZA(),s.YNc(9,Ie,1,2,"ng-template",null,8,s.W1O),s.YNc(11,Se,1,1,"ng-template",null,9,s.W1O),s.TgZ(13,"v-file-export",10),s.NdJ("export",function(r){return a.main.export(r)}),s.qZA(),s.TgZ(14,"div",11),s._UZ(15,"v-process-holder"),s.qZA()),2&t){const i=s.MAs(10),r=s.MAs(12);s.xp6(1),s.Q6J("ngClass",s.VKq(5,ce,"compare"!=a.nav.active)),s.xp6(2),s.Q6J("ngTemplateOutlet",r),s.xp6(1),s.Q6J("ngClass",s.VKq(7,ce,"history"!=a.nav.active)),s.xp6(4),s.Q6J("ngTemplateOutlet",i),s.xp6(5),s.Q6J("can",!0)}},directives:[w.mk,w.tP,Ae.n,w.sg,w.O5,re.z,V,$.G],styles:[""]}),e})(),Re=(()=>{class e{constructor(t,a){this.http=t,this.approval_process_service=a,this.headers=new k.WM,this.utility={soql_queries:{apexCodeCoverage:"query/?q=Select ApexClassorTriggerId,NumLinesCovered,NumLinesUncovered,Coverage from ApexCodeCoverageAggregate","Apex Classes":"query/?q=Select Id,ApiVersion,IsValid,LengthWithoutComments,Name,NamespacePrefix,Status,LastModifiedDate,CreatedDate,LastModifiedBy.Name,LastModifiedBy.Id,LastModifiedBy.Username,CreatedBy.Name,CreatedBy.Id,CreatedBy.Username from ApexClass","Apex Triggers":"query/?q=Select Id,ApiVersion,Name,EntityDefinitionId,EntityDefinition.DeveloperName,EntityDefinition.NamespacePrefix,EntityDefinition.MasterLabel,IsValid,LengthWithoutComments,Status,UsageAfterDelete,UsageAfterInsert,UsageAfterUndelete,UsageAfterUpdate,UsageBeforeDelete,UsageBeforeInsert,UsageBeforeUpdate,UsageIsBulk,LastModifiedDate,CreatedDate,LastModifiedBy.Name,CreatedBy.Name,LastModifiedBy.Id,CreatedBy.Id,LastModifiedBy.Username,CreatedBy.Username from ApexTrigger","Process builders and flows":"query/?q=Select Id,Definition.DeveloperName,Definition.NamespacePrefix,Description,ManageableState,MasterLabel,ProcessType,Status,VersionNumber from Flow","Visualforce Page Details":"query/?q=Select Id,Name,NamespacePrefix,Description,LastModifiedDate,CreatedDate,LastModifiedBy.Id,CreatedBy.Id,LastModifiedBy.Name,CreatedBy.Name,LastModifiedBy.Username,CreatedBy.Username,ApiVersion,ControllerKey,ManageableState from ApexPage","Validation Rules":"query/?q=Select Id,Active,Description,EntityDefinition.DeveloperName,ErrorDisplayField,ErrorMessage,NamespacePrefix,ValidationName from ValidationRule","Workflow Rules":"query/?q=Select Id,ManageableState,Name,NamespacePrefix,TableEnumOrId from WorkflowRule","Page Layouts":"query/?q=SELECT Id,TableEnumOrId,Name,LayoutType FROM Layout","Custom Settings":"query/?q=SELECT Id,Label,MasterLabel,PluralLabel,DeveloperName,QualifiedApiName,KeyPrefix,NamespacePrefix FROM EntityDefinition WHERE IsCustomSetting = true","Global Picklist Values":"query/?q=Select Id,DeveloperName,MasterLabel from GlobalValueSet","Profile Permissionset & User":"query/?q=Select Id,Name from Profile","Profile Creation & Modified":"query/?q=Select+Id,+Name,+CreatedBy.Name,+CreatedDate,+LastModifiedBy.Name,+LastModifiedDate+from+Profile","Custom Metadata Types":"query/?q=SELECT QualifiedApiName FROM EntityDefinition where QualifiedApiName Like '%25__mdt'"},url_queries:{"Object Details":"sobjects","Picklist Values":"sobjects"},soap_queries:{"Assignment Rules":{type:"AssignmentRules",fullnames:["Case","Lead"]}},pipes:{combine_composite_response:(0,j.U)(i=>{const r=[];return i.forEach(n=>r.push(...n.compositeResponse)),r.map(n=>n.body)})},compositer:({tooling:i,count:r,queries:n,url:l})=>{if(0===n.length)return(0,U.of)([]);const d={method:"GET"},p=C.X.data.salesforce.api.version,m=c.createChunks(n,r).map(b=>b.map((u,y)=>Object.assign(Object.assign({},d),{url:`/services/data/v${p+(i?"/tooling":"")}/${l(u)}`,referenceId:`${y}`}))),g=[];return m.forEach(b=>{g.push({allOrNone:!1,compositeRequest:b})}),(0,E.D)(g.map(b=>this.http.post(O.I8.instanceUrl+`/services/data/v${p}/${i?"tooling/":""}composite`,b,{headers:this.headers}))).pipe(this.utility.pipes.combine_composite_response)}},this.headers=this.headers.set("background",["true"])}getdata(t){const a=[...t];t.includes("Apex Classes")&&a.push("apexCodeCoverage");const i=[],r=[],n=[],l=[],d=[],p=[];a.forEach(u=>{this.utility.soql_queries[u]?(i.push(u),l.push(this.utility.soql_queries[u])):this.utility.url_queries[u]?(r.push(u),d.push(this.utility.url_queries[u])):this.utility.soap_queries[u]&&(n.push(u),p.push(this.utility.soap_queries[u]))});const m=l.length>0?this.utility.compositer({tooling:!0,count:5,queries:l,url:u=>u}).pipe((0,j.U)(u=>u.map(y=>y.records))):[(0,U.of)(null)],g=(0,E.D)(d.length>0?d.map(u=>this.getSObjects()):[(0,U.of)(null)]),b=(0,E.D)(p.length>0?p.map(u=>this.getdatasoap(u)):[(0,U.of)(null)]);return(0,E.D)([m,g,b]).pipe((0,j.U)(u=>{const y={},_=u[0],h=u[1],f=u[2];return i.forEach((v,T)=>{y[v]=_[T]}),r.forEach((v,T)=>{y[v]=h[T]}),n.forEach((v,T)=>{y[v]=f[T]}),y}),(0,le.z)(u=>{const y=Object.keys(u),_=[];return y.forEach(h=>{switch(h){case"apexCodeCoverage":{const f={};u[h].forEach(v=>{f[v.ApexClassOrTriggerId]=v}),_.push((0,U.of)(f))}break;case"Validation Rules":{const f=u[h].map(v=>v.Id);_.push(this.utility.compositer({tooling:!0,count:25,queries:f,url:v=>`sobjects/ValidationRule/${v}`}))}break;case"Workflow Rules":{const f=u[h].map(v=>v.Id);_.push(this.utility.compositer({tooling:!0,count:25,queries:f,url:v=>`sobjects/WorkflowRule/${v}`}))}break;case"Page Layouts":{const f=u[h].map(v=>v.Id);_.push(this.utility.compositer({tooling:!0,count:25,queries:f,url:v=>`sobjects/Layout/${v}`}))}break;case"Global Picklist Values":{const f=u[h].map(v=>v.Id);_.push(this.utility.compositer({tooling:!0,count:25,queries:f,url:v=>`sobjects/GlobalValueSet/${v}`}))}break;case"Custom Settings":{const f=u[h].map(v=>v.QualifiedApiName);_.push(this.utility.compositer({tooling:!1,count:25,queries:f,url:v=>`sobjects/${v}/describe`}))}break;case"Object Details":case"Picklist Values":{const f=u[h].map(v=>v.name);_.push(this.utility.compositer({tooling:!1,count:25,queries:f,url:v=>`sobjects/${v}/describe`}))}break;case"Custom Metadata Types":{const f=u[h].map(v=>v.QualifiedApiName);_.push(this.utility.compositer({tooling:!1,count:25,queries:f,url:v=>`sobjects/${v}/describe`}))}break;case"Profile Permissionset & User":{const f=u[h].map(v=>`'${v.Id}'`);_.push(this.getReportsData(`SELECT PermissionSetId, PermissionSet.Name, AssigneeId, Assignee.Name, Assignee.Profile.Name , Assignee.ProfileId FROM PermissionSetAssignment where PermissionSet.isOwnedByProfile=False and Assignee.ProfileId in ( ${f.join(", ")} )`))}break;default:_.push((0,U.of)(u[h]))}}),(0,E.D)(_).pipe((0,j.U)(h=>{const f={};return h.forEach((T,P)=>{f[y[P]]=T}),JSON.parse(JSON.stringify(f,(T,P)=>{if("attributes"!==T)return P||(!1===P||0==P?P:"")}))}))}))}getdatasoap(t){let a=t.fullnames.map(n=>`<tns:fullNames>${n}</tns:fullNames>`),i=`<?xml version="1.0" encoding="utf-8"?>\n      <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:tns="http://soap.sforce.com/2006/04/metadata" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">\n          <soapenv:Header>\n              <tns:SessionHeader>\n                  <tns:sessionId>${O.I8.sessiontoken}</tns:sessionId>\n              </tns:SessionHeader>\n          </soapenv:Header>\n          <soapenv:Body>\n              <tns:readMetadata xmlns="http://soap.sforce.com/2006/04/metadata">\n                  <tns:type>${t.type}</tns:type>`;return a.forEach(n=>{i+=n}),i+="</tns:readMetadata>\n          </soapenv:Body>\n      </soapenv:Envelope>",this.http.post(O.I8.instanceUrl+"/services/Soap/m/50.0",i,{responseType:"text",observe:"response"})}getReportsData(t){return this.http.get(O.I8.instanceUrl+`/services/data/v${C.X.data.salesforce.api.version}/query/?q=`+t,{headers:this.headers}).pipe(c.rxp.extract_response("records"))}getSObjects(){let t=new k.WM;return t=t.set("cache","SObjects_metadata"),t=t.set("background",["true"]),this.http.get(O.I8.instanceUrl+`/services/data/v${C.X.data.salesforce.api.version}/sobjects`,{headers:t}).pipe(c.rxp.extract_response("sobjects"))}}return e.\u0275fac=function(t){return new(t||e)(s.LFG(k.eN),s.LFG(oe))},e.\u0275prov=s.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function qe(e,o){if(1&e){const t=s.EpF();s.ynx(0),s.TgZ(1,"div",1),s.NdJ("click",function(){const r=s.CHM(t).$implicit;return s.oxw().UI.select(r.key)}),s.TgZ(2,"div"),s.TgZ(3,"div",2),s._uU(4),s.qZA(),s.TgZ(5,"div"),s._uU(6),s.qZA(),s.qZA(),s.TgZ(7,"div",3),s._UZ(8,"i"),s.qZA(),s.qZA(),s.BQk()}if(2&e){const t=o.$implicit,a=s.oxw();s.xp6(1),s.Gre("btn w-100 text-start btn-sm border-rounded my-1 d-flex justify-content-between ",a.UI.heighlighter[t.key]?"btn-success":"btn-light",""),s.xp6(3),s.hij(" ",t.key," "),s.xp6(2),s.hij(" ",t.value," "),s.xp6(2),s.Gre("bi bi-",a.UI.heighlighter[t.key]?"check-circle text-light":"x-circle","")}}let pe=(()=>{class e{constructor(){this.UI={select:t=>{const a=this.selection.indexOf(t);a>-1?this.selection.splice(a,1):this.selection.push(t),this.UI.update_heighlights()},heighlighter:{},update_heighlights:()=>{this.UI.heighlighter={},this.selection.forEach(t=>{this.UI.heighlighter[t]=1})}}}ngOnInit(){this.UI.update_heighlights()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Xpm({type:e,selectors:[["v-checklist"]],inputs:{list:"list",selection:"selection"},decls:2,vars:3,consts:[[4,"ngFor","ngForOf"],[3,"click"],[1,"fw-bold"],[1,"btn"]],template:function(t,a){1&t&&(s.YNc(0,qe,9,8,"ng-container",0),s.ALo(1,"keyvalue")),2&t&&s.Q6J("ngForOf",s.lcZ(1,1,a.list))},directives:[w.sg],pipes:[w.Nd],styles:[""]}),e})(),Fe=(()=>{class e{constructor(t){this.service=t,this.main={fetchdata:(a,i)=>{const r=this.service.getdata(a);C.X.operation.tasks.worker.create(r,"metadata",i).subscribe(n=>{N.writeFile(n,(i||"untitled")+".xlsx"),C.X.operation.support.update_count({report:!0})})},export:a=>{this.main.fetchdata(this.UI.selection,a)}},this.UI={types:{"Apex Classes":"Export your salesforce org's apex classes in detail","Apex Triggers":"Export your salesforce org's apex triggers in detail","Assignment Rules":"Export your salesforce org's Assignment rules in detail","Custom Metadata Types":"Export details of multiple Custom Metadata Types","Custom Settings":"Export details of multiple Custom Settings","Global Picklist Values":"Export details of multiple Global Picklist Valueset","Object Details":"Export Object Details, Standard and Custom Field detail for multiple objects","Page Layouts":"Export details of multiple page layouts for multiple objects","Picklist Values":"Export details of picklist values for multiple fields","Process builders and flows":"Export your salesforce org's process builders and flows in detail","Profile Creation & Modified Details":"Export creation and modified details of all the Profiles","Profile, Permission Set & User":"Export the relationship between Profiles, its Users and Permission Set assigned","Validation Rules":"Export your salesforce org's validation rules in details","Visualforce Page Details":"Export your salesforce org's Visual force page details in excel","Workflow Rules":"Export your salesforce org's workflow rules in detail"},selection:[]}}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(Re))},e.\u0275cmp=s.Xpm({type:e,selectors:[["app-metadata"]],decls:5,vars:3,consts:[[1,"h-100-80","overflow-auto","rounded","px-1"],[3,"list","selection"],["name","Metadata Reports",3,"can","export"],[1,"rounded","w-100","d-flex-child","overflow-auto"]],template:function(t,a){1&t&&(s.TgZ(0,"div",0),s._UZ(1,"v-checklist",1),s.qZA(),s.TgZ(2,"v-file-export",2),s.NdJ("export",function(r){return a.main.export(r)}),s.qZA(),s.TgZ(3,"div",3),s._UZ(4,"v-process-holder"),s.qZA()),2&t&&(s.xp6(1),s.Q6J("list",a.UI.types)("selection",a.UI.selection),s.xp6(1),s.Q6J("can",a.UI.selection.length>0))},directives:[pe,V,$.G],styles:[""]}),e})(),Ze=(()=>{class e{constructor(t){this.http=t,this.headers=new k.WM,this.utility={executequery:a=>this.http.get(O.I8.instanceUrl+"/services/data/v49.0/query/?q="+a,{headers:this.headers}),queries:{Admin:"SELECT Assignee.Id, Assignee.Username, Assignee.Name, PermissionSet.PermissionsModifyAllData, PermissionSet.PermissionsCustomizeApplication, PermissionSet.PermissionsManageUsers, PermissionSet.PermissionsViewAllData\n  FROM PermissionSetAssignment\n  WHERE (PermissionSet.PermissionsModifyAllData = true OR PermissionSet.PermissionsCustomizeApplication = true OR PermissionSet.PermissionsManageUsers = true OR\n  PermissionSet.PermissionsViewAllData = true) AND Assignee.IsActive=true","Data Export":"SELECT Assignee.Id,Assignee.Username,Assignee.Name\n  FROM PermissionSetAssignment\n  WHERE (PermissionSet.PermissionsExportReport = true OR PermissionSet.PermissionsDataExport = true) AND Assignee.IsActive=true","API Access":"SELECT Assignee.Id,Assignee.Username,Assignee.Name\n  FROM PermissionSetAssignment\n  WHERE PermissionSet.PermissionsApiEnabled = true AND Assignee.IsActive = true","Password Never Expires":"SELECT Assignee.Id,Assignee.Username,Assignee.Name\n  FROM PermissionSetAssignment\n  WHERE PermissionSet.PermissionsPasswordNeverExpires = true AND Assignee.IsActive=true","View All Modify All":"SELECT Assignee.Id,Assignee.Username,Assignee.Name\n  FROM PermissionSetAssignment\n  WHERE PermissionSetId in (\n  SELECT ParentId\n  FROM ObjectPermissions where (PermissionsViewAllRecords = true or PermissionsModifyAllRecords = true) And SObjectType = 'Opportunity')\n  AND Assignee.IsActive=true"}},this.headers=this.headers.set("background",["true"])}getdata(t){const a=t.map(d=>this.utility.queries[d]),i={method:"GET"},n=c.createChunks(a,5).map(d=>d.map((p,m)=>Object.assign(Object.assign({},i),{url:`/services/data/v${C.X.data.salesforce.api.version}/query/?q=`+p,referenceId:m+""}))),l=[];return n.forEach(d=>{l.push({allOrNone:!0,compositeRequest:d})}),(0,E.D)(l.map(d=>this.http.post(O.I8.instanceUrl+`/services/data/v${C.X.data.salesforce.api.version}/composite`,d,{headers:this.headers}))).pipe((0,j.U)(d=>{let p=[];d.forEach(b=>p.push(...b.compositeResponse)),p=p.map(b=>b.body.records);const m={};return t.forEach((b,u)=>{m[b]=p[u]}),JSON.parse(JSON.stringify(m,(b,u)=>{if("attributes"!==b)return u}))}))}}return e.\u0275fac=function(t){return new(t||e)(s.LFG(k.eN))},e.\u0275prov=s.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Be=(()=>{class e{constructor(t){this.service=t,this.main={fetchdata:(a,i)=>{const r=this.service.getdata(a);C.X.operation.tasks.worker.create(r,"superuser",i).subscribe(n=>{N.writeFile(n,(i||"untitled")+".xlsx"),C.X.operation.support.update_count({report:!0})})},export:a=>{this.main.fetchdata(this.UI.selection,a)}},this.UI={types:{Admin:"users with Customize Application, Manager Users, View All Data, and Modify All Data permissions","Data Export":"users with all Data Export permissions","API Access":"users with Access to the Salesforce API","Password Never Expires":"users who are able to have a Never Expiring Password","View All Modify All":"users who are able to View and Modify all objects, and their details"},selection:[]}}ngOnInit(){this.UI.selection=Object.keys(this.UI.types)}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(Ze))},e.\u0275cmp=s.Xpm({type:e,selectors:[["app-superuser"]],decls:5,vars:3,consts:[[1,"h-100-80","overflow-auto","rounded","px-1"],[3,"list","selection"],["name","Superuser Report",3,"can","export"],[1,"rounded","w-100","d-flex-child","overflow-auto"]],template:function(t,a){1&t&&(s.TgZ(0,"div",0),s._UZ(1,"v-checklist",1),s.qZA(),s.TgZ(2,"v-file-export",2),s.NdJ("export",function(r){return a.main.export(r)}),s.qZA(),s.TgZ(3,"div",3),s._UZ(4,"v-process-holder"),s.qZA()),2&t&&(s.xp6(1),s.Q6J("list",a.UI.types)("selection",a.UI.selection),s.xp6(1),s.Q6J("can",a.UI.selection.length>0))},directives:[pe,V,$.G],styles:[""]}),e})();var Ve=A(623);let $e=(()=>{class e{constructor(){this.routes=O.gT.reports.routes.slice(1),this.local_routes=this.routes.slice(),this.UI={search:{keyword:"",filter:()=>{const t=this.UI.search.keyword;this.local_routes=""!=this.UI.search.keyword?this.routes.filter(a=>JSON.stringify(a).toLocaleLowerCase().includes(t.toLocaleLowerCase())):this.routes.slice()},clear:()=>{this.UI.search.keyword="",this.UI.search.filter()}}}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Xpm({type:e,selectors:[["app-menu"]],decls:1,vars:1,consts:[[3,"list"]],template:function(t,a){1&t&&s._UZ(0,"v-search-menu",0),2&t&&s.Q6J("list",a.routes)},directives:[Ve.B],styles:[""]}),e})();function Je(e,o){if(1&e&&(s.TgZ(0,"div",4),s._uU(1),s.qZA()),2&e){const t=o.$implicit;s.Q6J("routerLink",t.url),s.xp6(1),s.hij(" ",t.title," ")}}const He=[{path:"",redirectTo:"menu",pathMatch:"full"},{path:"",component:(()=>{class e{constructor(){this.routes=O.gT.reports.routes}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Xpm({type:e,selectors:[["app-reports"]],decls:5,vars:1,consts:[[1,"tabbed-panel"],[1,"body"],["id","navbar",1,"nav-container"],["class","","routerLinkActive","active",3,"routerLink",4,"ngFor","ngForOf"],["routerLinkActive","active",1,"",3,"routerLink"]],template:function(t,a){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s._UZ(2,"router-outlet"),s.qZA(),s.TgZ(3,"div",2),s.YNc(4,Je,2,2,"div",3),s.qZA(),s.qZA()),2&t&&(s.xp6(4),s.Q6J("ngForOf",a.routes))},directives:[D.lC,w.sg,D.Od,D.rH],styles:[""]}),e})(),children:[{path:"menu",component:$e},{path:"metadata",component:Fe},{path:"approval-process",component:ve},{path:"superuser",component:Be},{path:"compare-profile-permissionset",component:De}]}];let Xe=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.oAB({type:e}),e.\u0275inj=s.cJS({imports:[[D.Bz.forChild(He)],D.Bz]}),e})();var Qe=A(3985),Ge=A(2627);let We=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.oAB({type:e}),e.\u0275inj=s.cJS({imports:[[w.ez,Xe,Qe.W,B.u5,Ge.m]]}),e})()}}]);