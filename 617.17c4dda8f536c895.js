"use strict";(self.webpackChunksfsce=self.webpackChunksfsce||[]).push([[617],{5617:(ne,G,c)=>{c.r(G),c.d(G,{CloneGlobalPicklistModule:()=>le});var C=c(9808),b=c(2897),g=c(3075),S=c(321),w=c(9446),A=c(1375),M=c(3985),Z=c(1533),P=c(5861),k=c(4999),v=c(4004),T=c(4128),h=c(7555),e=c(5e3),I=c(520);let U=(()=>{class l{constructor(t){this.http=t}getAllGlobalPicklist(){return this.http.get(k.I8.instanceUrl+`/services/data/v${h.X.data.salesforce.api.version}/tooling/query/?q=Select Id from GlobalValueSet`).pipe((0,v.U)(o=>(o.records.forEach(n=>{delete n.attributes}),o.records)))}createChunks(t,o){return Array(Math.ceil(t.length/o)).fill(0).map((i,d)=>t.slice(d*o,o*(d+1)))}getMetaDataForRecordIds(t){const o={method:"GET"},n=this.createChunks(t,25).map(a=>a.map((m,r)=>Object.assign(Object.assign({},o),{url:`/services/data/v${h.X.data.salesforce.api.version}/tooling/sobjects/GlobalValueSet/`+m,referenceId:r+""}))),i=[];return n.forEach(a=>{i.push({allOrNone:!1,compositeRequest:a})}),(0,T.D)(i.map(a=>this.http.post(k.I8.instanceUrl+`/services/data/v${h.X.data.salesforce.api.version}/tooling/composite`,a))).pipe((0,v.U)(a=>{let m=[];return a.forEach(r=>m.push(...r.compositeResponse)),m}))}createClone(t){const o={method:"POST"},n=this.createChunks(t,25).map(a=>a.map((m,r)=>Object.assign(Object.assign({},o),{url:`/services/data/v${h.X.data.salesforce.api.version}/tooling/sobjects/GlobalValueSet`,referenceId:r+"",body:m}))),i=[];return n.forEach(a=>{i.push({allOrNone:!1,compositeRequest:a})}),(0,T.D)(i.map(a=>this.http.post(k.I8.instanceUrl+`/services/data/v${h.X.data.salesforce.api.version}/tooling/composite`,a))).pipe((0,v.U)(a=>{let m=[];return a.forEach(r=>m.push(...r.compositeResponse)),m}))}}return l.\u0275fac=function(t){return new(t||l)(e.LFG(I.eN))},l.\u0275prov=e.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})();var O=c(6921),N=c(6805),L=c(3934),J=c(3911),p=c(2463);const R=["table"];function F(l,s){1&l&&e.GkF(0)}function V(l,s){1&l&&e.GkF(0)}function q(l,s){if(1&l&&(e.TgZ(0,"div",6),e.TgZ(1,"span",7),e._uU(2),e.qZA(),e.qZA()),2&l){const t=e.oxw();e.xp6(2),e.hij(" ",t.UI.selectedvalueSets>0?t.UI.selectedvalueSets+" / "+t.main.valueSets.length+" Global Picklist Selected":""," ")}}function B(l,s){if(1&l&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.qZA()),2&l){const t=s.$implicit;e.xp6(2),e.Oqu(t.label),e.xp6(2),e.Oqu(t.valueName)}}function H(l,s){if(1&l&&(e.TgZ(0,"div",8),e.TgZ(1,"div",9),e.TgZ(2,"table",10),e.TgZ(3,"thead"),e.TgZ(4,"tr"),e.TgZ(5,"th",11),e._uU(6,"Label"),e.qZA(),e.TgZ(7,"th",11),e._uU(8,"Value"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(9,"tbody"),e.YNc(10,B,5,2,"tr",12),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&l){const t=e.oxw();e.xp6(10),e.Q6J("ngForOf",t.currentPicklistValue.Metadata.customValue)}}function j(l,s){1&l&&(e.TgZ(0,"div",27),e._UZ(1,"input",28),e.qZA(),e.TgZ(2,"div",29),e._uU(3,"Select All"),e.qZA())}function Q(l,s){if(1&l){const t=e.EpF();e.TgZ(0,"input",31),e.NdJ("ngModelChange",function(n){return e.CHM(t),e.oxw().$implicit.newLabel=n}),e.qZA()}if(2&l){const t=e.oxw().$implicit;e.Q6J("ngModel",t.newLabel)}}function Y(l,s){1&l&&e.YNc(0,Q,1,1,"input",30),2&l&&e.Q6J("ngIf",s.$implicit.Selected)}function D(l,s){if(1&l){const t=e.EpF();e.TgZ(0,"div",32),e.TgZ(1,"button",33),e.NdJ("click",function(){const i=e.CHM(t).$implicit,d=e.oxw(3),a=e.MAs(7);return d.UI.open(i,a)}),e._uU(2," View "),e.qZA(),e.qZA()}}const $=function(){return{checkboxOnly:!0,mode:"multiple"}};function W(l,s){if(1&l){const t=e.EpF();e.TgZ(0,"kendo-grid",17,18),e.NdJ("selectionChange",function(n){return e.CHM(t),e.oxw(2).UI.checkboxHandler(n)})("cellClick",function(n){return e.CHM(t),e.oxw(2).cellClickHandler(n)})("cellClose",function(n){return e.CHM(t),e.oxw(2).cellCloseHandler(n)}),e.TgZ(2,"kendo-grid-checkbox-column",19),e.YNc(3,j,4,0,"ng-template",20),e.qZA(),e._UZ(4,"kendo-grid-column",21),e._UZ(5,"kendo-grid-column",22),e._UZ(6,"kendo-grid-column",23),e.TgZ(7,"kendo-grid-column",24),e.YNc(8,Y,1,1,"ng-template",25),e.qZA(),e.TgZ(9,"kendo-grid-column",26),e.YNc(10,D,3,0,"ng-template",25),e.qZA(),e.qZA()}if(2&l){const t=e.oxw(2);e.Q6J("kendoGridBinding",t.main.valueSets)("scrollable",!0)("selectable",e.DdM(13,$))("rowSelected",t.main.grid.rowselected)("filter",t.state.filter)("navigable",!0)("filterable",!0),e.xp6(2),e.Q6J("width",100),e.xp6(2),e.Q6J("editable",!1),e.xp6(1),e.Q6J("editable",!1),e.xp6(1),e.Q6J("editable",!1),e.xp6(1),e.Q6J("filterable",!1)("editable",!1)}}function X(l,s){if(1&l){const t=e.EpF();e.TgZ(0,"button",34),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).main.init()}),e._uU(1," Refresh "),e._UZ(2,"i",35),e.qZA()}}function z(l,s){if(1&l){const t=e.EpF();e.TgZ(0,"button",36),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).main.createClone()}),e._uU(1," Clone Value Sets "),e.qZA()}if(2&l){const t=e.oxw(2);e.Q6J("disabled",t.UI.disableButton)}}function K(l,s){if(1&l&&(e.YNc(0,W,11,14,"kendo-grid",13),e.TgZ(1,"div",14),e.YNc(2,X,3,0,"button",15),e.YNc(3,z,2,1,"button",16),e.qZA()),2&l){const t=e.oxw();e.Q6J("ngIf",t.main.showGrid),e.xp6(2),e.Q6J("ngIf",t.main.showGrid),e.xp6(1),e.Q6J("ngIf",t.main.showGrid)}}const ee=[{path:"",component:(()=>{class l{constructor(t,o){var i,n=this;this.Service=t,this.formBuilder=o,this.state={filter:{logic:"and",filters:[]}},this.currentPicklistValue={},this.main={showGrid:!1,subs:new O.w0,valueSets:[],grid:{rowselected:i=>i.dataItem.Selected},init:()=>{this.state={filter:{logic:"and",filters:[]}},this.main.subs.add(this.Service.getAllGlobalPicklist().subscribe(function(){var i=(0,P.Z)(function*(d){let a=[],m=[];d.forEach(r=>{m.push(r.Id)}),m.length>0?(yield function E(l,s){const t="object"==typeof s;return new Promise((o,n)=>{const i=new L.Hp({next:d=>{o(d),i.unsubscribe()},error:n,complete:()=>{t?o(s.defaultValue):n(new N.K)}});l.subscribe(i)})}(n.Service.getMetaDataForRecordIds(m)).then(r=>{r.forEach(u=>{var f;if(200==u.httpStatusCode){let _=u.body;_.newLabel="",_.Selected=!1,a.push(_)}else p.y.maketoast({template:"ERROR",body:null===(f=u.body[0])||void 0===f?void 0:f.message,duration:2e4})})}),n.main.valueSets=a,p.y.maketoast({template:"SUCCESS",body:n.main.valueSets.length+" Global Picklist Fetched.",duration:1e3})):(n.main.valueSets=a,p.y.maketoast({template:"WARNING",body:"No Global Picklist found in this Org.",duration:5e3})),n.main.showGrid=!0,n.UI.checkButtonVisibltiy()});return function(d){return i.apply(this,arguments)}}()))},createClone:(i=(0,P.Z)(function*(){const d=n.main.valueSets.filter(r=>r.Selected);let a=[],m=!0;d.forEach(r=>{if(""==r.newLabel.trim())p.y.maketoast({template:"WARNING",body:`Cloned Picklist Label of Picklist - ( ${r.MasterLabel} ) can't be empty`,duration:5e3}),m=!1;else{let u=Object.assign({},r.Metadata);u.masterLabel=r.newLabel,a.push({Metadata:u,FullName:r.newLabel.trim().replaceAll(" ","_")})}}),m&&n.main.subs.add(n.Service.createClone(a).subscribe(r=>{n.main.showGrid=!1;let u=0;r.forEach(f=>{var _,x,y;(null===(_=f.body[0])||void 0===_?void 0:_.message)&&p.y.maketoast({template:"ERROR",body:null===(x=f.body[0])||void 0===x?void 0:x.message,duration:2e4}),(null===(y=f.body)||void 0===y?void 0:y.success)&&u++}),u>0&&p.y.maketoast({template:"SUCCESS",body:d.length+" out of "+u+" clone operations were successfull"}),n.main.init()}))}),function(){return i.apply(this,arguments)})},this.UI={disableButton:!0,selectedvalueSets:0,checkButtonVisibltiy:()=>{let i=this.main.valueSets.filter(d=>d.Selected).length;this.UI.selectedvalueSets=i,this.UI.disableButton=!(i>0)},open:(i,d)=>{this.currentPicklistValue=Object.assign({},i),p.y.ask({title:"Picklist Values",callback:()=>{},template:d,hidefooter:!0})},checkboxHandler:i=>{(i.selectedRows.length>0?i.selectedRows:i.deselectedRows).forEach(a=>{a.dataItem.Selected=!a.dataItem.Selected,a.dataItem.newLabel=i.selectedRows.length>0?("Copy of "+a.dataItem.MasterLabel).substring(0,40):""}),this.UI.checkButtonVisibltiy()}}}ngOnInit(){this.main.init()}ngOnDestroy(){this.main.subs.unsubscribe(),p.y.clearAsk()}cellClickHandler(t){t.isEdited||t.sender.editCell(t.rowIndex,t.columnIndex,this.createFormGroup(t.dataItem))}cellCloseHandler(t){this.UI.checkButtonVisibltiy();const{formGroup:o,dataItem:n}=t;if(null==o?void 0:o.valid){if(o.dirty){if(t.originalEvent&&t.originalEvent.keyCode===J.R8.Escape)return;Object.assign(n,o.value)}}else t.preventDefault()}createFormGroup(t){let o=this.main.valueSets.findIndex(({Id:n})=>n===t.Id);return this.main.valueSets[o].Selected=!0,""==this.main.valueSets[o].newLabel.trim()?(this.main.valueSets[o].newLabel=("Copy of "+t.MasterLabel).substring(0,40),this.UI.checkButtonVisibltiy(),this.formBuilder.group({Id:t.Id,DeveloperName:t.DeveloperName,MasterLabel:t.MasterLabel,newLabel:("Copy of "+t.MasterLabel).substring(0,40)})):(this.UI.checkButtonVisibltiy(),this.formBuilder.group({Id:t.Id,DeveloperName:t.DeveloperName,MasterLabel:t.MasterLabel,newLabel:this.main.valueSets[o].newLabel}))}}return l.\u0275fac=function(t){return new(t||l)(e.Y36(U),e.Y36(g.qu))},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-clone-global-picklist"]],viewQuery:function(t,o){if(1&t&&e.Gf(R,5),2&t){let n;e.iGM(n=e.CRH())&&(o.grid=n.first)}},decls:10,vars:2,consts:[[1,"tabbed-panel"],[1,"body"],[4,"ngTemplateOutlet"],["localfooter",""],["temp",""],["grid",""],[1,"footer-container"],[1,"text-center"],[1,"modal-content"],[1,"modal-body"],[1,"table","table-striped","table-bordered",2,"width","50vw"],["scope","col"],[4,"ngFor","ngForOf"],["id","picklistgrid","sortable","true","class","text-small h-100-40","style","background-color: inherit !important",3,"kendoGridBinding","scrollable","selectable","rowSelected","filter","navigable","filterable","selectionChange","cellClick","cellClose",4,"ngIf"],[1,"d-flex","p-1"],["id","refreshbtn","class","btn btn-sm btn-light me-1 ms-1 mt-1 mb-1",3,"click",4,"ngIf"],["id","clonebtn","class","btn btn-sm btn-danger me-1 ms-1 mt-1 mb-1",3,"disabled","click",4,"ngIf"],["id","picklistgrid","sortable","true",1,"text-small","h-100-40",2,"background-color","inherit !important",3,"kendoGridBinding","scrollable","selectable","rowSelected","filter","navigable","filterable","selectionChange","cellClick","cellClose"],["table",""],["showSelectAll","true",3,"width"],["kendoGridHeaderTemplate",""],["title","Label","field","MasterLabel",3,"editable"],["title","Name","field","DeveloperName",3,"editable"],["field","Description",3,"editable"],["title","Cloned Picklist Label","field","newLabel",3,"filterable","editable"],["kendoGridCellTemplate",""],["title","Actions","width","100",1,"cursor-normal"],[1,"inline-div"],["kendoGridSelectAllCheckbox","","type","checkbox","id","headerCheckbox",1,"k-checkbox"],[1,"inline-div",2,"padding-left","0.5vw"],["type","text","class","form-control form-control-sm form-control-focus","maxlength","40",3,"ngModel","ngModelChange",4,"ngIf"],["type","text","maxlength","40",1,"form-control","form-control-sm","form-control-focus",3,"ngModel","ngModelChange"],[1,"d-flex","justify-content-center"],["id","viewbtn",1,"btn","btn-light","btn-sm","me-1",3,"click"],["id","refreshbtn",1,"btn","btn-sm","btn-light","me-1","ms-1","mt-1","mb-1",3,"click"],[1,"bi","bi-arrow-clockwise"],["id","clonebtn",1,"btn","btn-sm","btn-danger","me-1","ms-1","mt-1","mb-1",3,"disabled","click"]],template:function(t,o){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.YNc(2,F,1,0,"ng-container",2),e.qZA(),e.YNc(3,V,1,0,"ng-container",2),e.qZA(),e.YNc(4,q,3,1,"ng-template",null,3,e.W1O),e.YNc(6,H,11,1,"ng-template",null,4,e.W1O),e.YNc(8,K,4,3,"ng-template",null,5,e.W1O)),2&t){const n=e.MAs(5),i=e.MAs(9);e.xp6(2),e.Q6J("ngTemplateOutlet",i),e.xp6(1),e.Q6J("ngTemplateOutlet",n)}},directives:[C.tP,C.sg,C.O5,b.MwP,b.HWw,b.HbC,b._cx,b.Gtk,b.bg4,b.Ztq,g.Fj,g.nD,g.JJ,g.On],styles:[".inline-div[_ngcontent-%COMP%]{display:inline-block}.k-checkbox[_ngcontent-%COMP%]:checked{border-color:#6495ed!important;background-color:#6495ed!important}.k-checkbox[_ngcontent-%COMP%]:indeterminate{color:#6495ed!important}.form-control-focus[_ngcontent-%COMP%]{border-color:#6495ed;box-shadow:0 0 0 .2rem #2885f640}#headerCheckbox[_ngcontent-%COMP%]{width:16px;height:16px;border-radius:4px}"]}),l})()}];let te=(()=>{class l{}return l.\u0275fac=function(t){return new(t||l)},l.\u0275mod=e.oAB({type:l}),l.\u0275inj=e.cJS({imports:[[Z.Bz.forChild(ee)],Z.Bz]}),l})(),le=(()=>{class l{}return l.\u0275fac=function(t){return new(t||l)},l.\u0275mod=e.oAB({type:l}),l.\u0275inj=e.cJS({imports:[[C.ez,te,b.zE6,S.q2,g.u5,w.rw,g.UX,A.cP,M.W]]}),l})()}}]);