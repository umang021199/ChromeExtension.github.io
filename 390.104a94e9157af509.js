"use strict";(self.webpackChunksfsce=self.webpackChunksfsce||[]).push([[390],{4390:(ue,N,p)=>{p.r(N),p.d(N,{ApexTestModule:()=>he});var f=p(9808),k=p(1533),w=p(6921),C=p(2463),U=p(520),Z=p(9646),M=p(4004),J=p(262),u=p(7555),g=p(4999),e=p(5e3);let S=(()=>{class s{constructor(i,t){this.http=i,this.router=t,this.watchers={apextest:!1,lastresult:{Id:""}},this.soql={apexclass:"Select Id, Name, SymbolTable, ApiVersion, IsValid, Status, LastModifiedBy.Name from ApexClass where ManageableState != 'installed'",apextrigger:"Select Id, Name, ApiVersion, IsValid, Status, LastModifiedBy.Name from ApexTrigger where ManageableState !='installed'",apexcodecoverageaggreate:"Select ApexClassorTriggerId, NumLinesCovered,NumLinesUncovered from ApexCodeCoverageAggregate"},this.utility={convertTestJsontoArray:(o,n)=>{let d=[];return Object.keys(o).forEach(a=>{const l=n.find(m=>m.Name==a);let c={};if("All Methods Selected"==o[a])c.classId=l.Id;else{const m=o[a].split(",");c.classId=l.Id,c.testMethods=m}d.push(c)}),d}}}getresultsforwatcher(i){return this.watchers.apextest||!this.watchers.apextest?this.executeTestResultRequest(i):(0,Z.of)()}getnotification(i){let t=[...i];if(t=t.filter(n=>n.QueueItem&&"Completed"==n.QueueItem),"granted"!==Notification.permission)Notification.requestPermission();else if(this.watchers.apextest){let n="";const a=(t.map(l=>l.Id)||[]).findIndex(l=>l==this.watchers.lastresult.Id);if(this.watchers.lastresult=Object.assign({},t[0]),a<1||(n=a+" Test Execution Finished",!u.X.data.notifications.system.enabled||!u.X.datatemp.tasks.poll.activeTest))return;new Notification("Apex Test",{icon:"../../../../assets/images/logo/icon.png",body:n}).onclick=()=>{window.focus()}}}makeToolingCompositeRequest(){const i={method:"GET"},t=Object.keys(this.soql).map((n,d)=>Object.assign(Object.assign({},i),{url:`/services/data/v${u.X.data.salesforce.api.version}/tooling/query/?q=${this.soql[n]}`,referenceId:d+""}));return this.http.post(g.I8.instanceUrl+`/services/data/v${u.X.data.salesforce.api.version}/tooling/composite`,{allOrNone:!0,compositeRequest:t})}executeTestRequest(i,t,o){const n=g.I8.instanceUrl+`/services/data/v${u.X.data.salesforce.api.version}/tooling/runTestsAsynchronous`;if(1!=o){const d=this.utility.convertTestJsontoArray(i,t);let a={};return a.tests=d,this.http.post(n,a).pipe((0,M.U)(l=>l),(0,J.K)(l=>(0,Z.of)(void 0)))}return this.http.post(n,{testLevel:"RunAllTestsInOrg"})}executeTestResultRequest(i){if(i.length>0){let t="";i.forEach(a=>{t+=`'${a}',`}),t=t.substring(0,t.length-1);const n=g.I8.instanceUrl+`/services/data/v${u.X.data.salesforce.api.version}/tooling/query/?q=Select ApexClassId, ApexTestRunResult.MethodsEnqueued,ApexTestRunResult.Status, ApexClass.Name ,AsyncApexJobId, MethodName, Message, Outcome, QueueItem.Status, TestTimestamp from ApexTestResult where AsyncApexJobId IN ${i=`(${t})`} ORDER BY TestTimestamp DESC`;let d=new U.WM;return d=d.set("background",["true"]),this.http.get(n,{headers:d}).pipe((0,M.U)(a=>(a.records.forEach(l=>{delete l.attributes}),a.records)))}return(0,Z.of)([])}}return s.\u0275fac=function(i){return new(i||s)(e.LFG(U.eN),e.LFG(k.F0))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var v=p(1371),I=p(2897),A=p(3513),R=p(8843),y=p(3075);function O(s,r){1&s&&e.GkF(0)}function q(s,r){if(1&s&&(e.TgZ(0,"span"),e.YNc(1,O,1,0,"ng-container",10),e.qZA()),2&s){e.oxw();const i=e.MAs(9);e.xp6(1),e.Q6J("ngTemplateOutlet",i)}}function E(s,r){1&s&&e.GkF(0)}function Q(s,r){if(1&s&&(e.TgZ(0,"span"),e.YNc(1,E,1,0,"ng-container",10),e.qZA()),2&s){e.oxw();const i=e.MAs(11);e.xp6(1),e.Q6J("ngTemplateOutlet",i)}}function F(s,r){1&s&&e.GkF(0)}function G(s,r){if(1&s&&(e.TgZ(0,"span"),e.YNc(1,F,1,0,"ng-container",10),e.qZA()),2&s){e.oxw();const i=e.MAs(13);e.xp6(1),e.Q6J("ngTemplateOutlet",i)}}function Y(s,r){1&s&&e.GkF(0)}function j(s,r){if(1&s&&(e.TgZ(0,"span"),e.YNc(1,Y,1,0,"ng-container",10),e.qZA()),2&s){e.oxw();const i=e.MAs(15);e.xp6(1),e.Q6J("ngTemplateOutlet",i)}}const P=function(s){return{activeTab:s}};function L(s,r){if(1&s){const i=e.EpF();e.TgZ(0,"div",11),e.NdJ("click",function(){const n=e.CHM(i).$implicit;return e.oxw().UI.changeRoute(n)}),e._uU(1),e.qZA()}if(2&s){const i=r.$implicit,t=e.oxw();e.Q6J("ngClass",e.VKq(2,P,i==t.UI.selectedRoute)),e.xp6(1),e.hij(" ",i," ")}}function $(s,r){if(1&s){const i=e.EpF();e.TgZ(0,"ul",28),e.TgZ(1,"li",29),e.TgZ(2,"b"),e._uU(3,"Method"),e.qZA(),e._uU(4),e.TgZ(5,"i",26),e.NdJ("click",function(){const n=e.CHM(i).$implicit,d=e.oxw().$implicit;return e.oxw(3).UI.removeMethod(d.key,n)}),e.qZA(),e.qZA(),e.qZA()}if(2&s){const i=r.$implicit;e.xp6(4),e.hij(" - ",i," ")}}function W(s,r){if(1&s){const i=e.EpF();e.TgZ(0,"div",24),e.TgZ(1,"div",25),e.TgZ(2,"b"),e._uU(3,"Class"),e.qZA(),e._uU(4),e.TgZ(5,"i",26),e.NdJ("click",function(){const n=e.CHM(i).$implicit;return e.oxw(3).UI.removeClass(n.key)}),e.qZA(),e.qZA(),e.YNc(6,$,6,1,"ul",27),e.qZA()}if(2&s){const i=r.$implicit;e.xp6(4),e.hij(" - ",i.key," "),e.xp6(2),e.Q6J("ngForOf",i.value.split(","))}}const B=function(){return{overflow:"auto","font-size":"small"}};function H(s,r){if(1&s){const i=e.EpF();e.TgZ(0,"div",14),e.TgZ(1,"div",15),e.TgZ(2,"div",16),e.TgZ(3,"kendo-treeview",17),e.NdJ("checkedKeysChange",function(o){return e.CHM(i),e.oxw(2).UI.checkedKeys=o})("checkedChange",function(o){return e.CHM(i),e.oxw(2).main.handleChecking(o)}),e.qZA(),e.qZA(),e._UZ(4,"hr"),e.TgZ(5,"div",18),e.TgZ(6,"button",19),e.NdJ("click",function(){e.CHM(i);const o=e.oxw(2),n=e.MAs(17);return o.UI.executeTest(n)}),e._uU(7," Execute Test "),e.qZA(),e.TgZ(8,"button",20),e.NdJ("click",function(){return e.CHM(i),e.oxw(2).UI.clearSelection()}),e._uU(9," Clear All Selections "),e.qZA(),e.TgZ(10,"button",21),e.NdJ("click",function(){return e.CHM(i),e.oxw(2).UI.reset(!0)}),e._uU(11," Refresh "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(12,"div",22),e.YNc(13,W,7,2,"div",23),e.ALo(14,"keyvalue"),e.qZA(),e.qZA()}if(2&s){const i=e.oxw(2);e.xp6(3),e.Q6J("nodes",i.main.testClassMappedWithMethods)("filterable",!0)("ngStyle",e.DdM(8,B))("checkedKeys",i.UI.checkedKeys)("expandOnFilter",i.filterExpandSettings),e.xp6(10),e.Q6J("ngForOf",e.lcZ(14,6,i.main.checkedTestClass))}}function K(s,r){1&s&&(e.TgZ(0,"div",30),e.TgZ(1,"div",31),e.TgZ(2,"div",32),e._UZ(3,"span",33),e._uU(4," Loading... "),e.qZA(),e.qZA(),e.qZA())}function V(s,r){if(1&s&&(e.YNc(0,H,15,9,"div",12),e.YNc(1,K,5,0,"div",13)),2&s){const i=e.oxw();e.Q6J("ngIf",i.main.showGrid),e.xp6(1),e.Q6J("ngIf",0==i.main.showGrid)}}function X(s,r){if(1&s&&(e.TgZ(0,"kendo-grid",36),e._UZ(1,"kendo-grid-column",37),e._UZ(2,"kendo-grid-column",38),e._UZ(3,"kendo-grid-column",39),e._UZ(4,"kendo-grid-column",40),e._UZ(5,"kendo-grid-column",41),e._UZ(6,"kendo-grid-column",42),e._UZ(7,"kendo-grid-column",43),e.qZA()),2&s){const i=e.oxw(2);e.Q6J("kendoGridBinding",i.main.apexClassesAndTriggersCombined)("scrollable",!0)("filter",i.state.filter)("filterable","menu"),e.xp6(1),e.Q6J("editable",!1),e.xp6(1),e.Q6J("editable",!1),e.xp6(1),e.Q6J("editable",!1),e.xp6(1),e.Q6J("editable",!1),e.xp6(1),e.Q6J("editable",!1),e.xp6(1),e.Q6J("editable",!1),e.xp6(1),e.Q6J("editable",!1)}}function z(s,r){if(1&s){const i=e.EpF();e.TgZ(0,"div",44),e.TgZ(1,"button",45),e.NdJ("click",function(){return e.CHM(i),e.oxw(2).UI.reset(!1)}),e._uU(2," Refresh "),e._UZ(3,"i",46),e.qZA(),e.qZA()}}function D(s,r){1&s&&(e.TgZ(0,"div",30),e.TgZ(1,"div",31),e.TgZ(2,"div",32),e._UZ(3,"span",33),e._uU(4," Loading... "),e.qZA(),e.qZA(),e.qZA())}function ee(s,r){if(1&s&&(e.YNc(0,X,8,11,"kendo-grid",34),e.YNc(1,z,4,0,"div",35),e.YNc(2,D,5,0,"div",13)),2&s){const i=e.oxw();e.Q6J("ngIf",i.main.showGrid),e.xp6(1),e.Q6J("ngIf",i.main.showGrid),e.xp6(1),e.Q6J("ngIf",0==i.main.showGrid)}}function te(s,r){1&s&&(e._uU(0),e.ALo(1,"date")),2&s&&e.hij(" ",e.xi3(1,1,r.$implicit.Timestamp,"medium")," ")}function se(s,r){if(1&s&&(e.TgZ(0,"kendo-treelist",48),e._UZ(1,"kendo-treelist-column",49),e._UZ(2,"kendo-treelist-column",50),e._UZ(3,"kendo-treelist-column",51),e._UZ(4,"kendo-treelist-column",52),e._UZ(5,"kendo-treelist-column",53),e.TgZ(6,"kendo-treelist-column",54),e.YNc(7,te,2,4,"ng-template",55),e.qZA(),e.qZA()),2&s){const i=e.oxw(2);e.Q6J("kendoTreeListFlatBinding",i.main.apexTestResults)("height",410)("sortable",!0),e.xp6(1),e.Q6J("expandable",!0)("width",225),e.xp6(1),e.Q6J("width",150),e.xp6(1),e.Q6J("width",50),e.xp6(1),e.Q6J("width",50),e.xp6(1),e.Q6J("width",50),e.xp6(1),e.Q6J("width",100)("editable",!1)}}function ie(s,r){if(1&s){const i=e.EpF();e.TgZ(0,"div",44),e.TgZ(1,"button",56),e.NdJ("click",function(){return e.CHM(i),e.oxw(2).main.getTestExecutionResult(!0)}),e._uU(2," Refresh "),e._UZ(3,"i",46),e.qZA(),e.TgZ(4,"button",57),e.NdJ("click",function(){return e.CHM(i),e.oxw(2).UI.clearTestRun()}),e._uU(5," Clear "),e._UZ(6,"i",58),e.qZA(),e.TgZ(7,"button",59),e.NdJ("click",function(){return e.CHM(i),e.oxw(2).UI.setlive()}),e._UZ(8,"i"),e._uU(9," LIVE "),e.qZA(),e.qZA()}if(2&s){const i=e.oxw(2);e.xp6(8),e.Gre("bi bi-circle-fill ignoretheme\n          ",i.UI.live?"text-danger red-light-shadow":"text-secondary","")}}function ne(s,r){1&s&&(e.TgZ(0,"div",30),e.TgZ(1,"div",31),e.TgZ(2,"div",32),e._UZ(3,"span",33),e._uU(4," Loading... "),e.qZA(),e.qZA(),e.qZA())}function oe(s,r){if(1&s&&(e.YNc(0,se,8,11,"kendo-treelist",47),e.YNc(1,ie,10,3,"div",35),e.YNc(2,ne,5,0,"div",13)),2&s){const i=e.oxw();e.Q6J("ngIf",i.main.showGrid),e.xp6(1),e.Q6J("ngIf",i.main.showGrid),e.xp6(1),e.Q6J("ngIf",0==i.main.showGrid)}}function ae(s,r){if(1&s){const i=e.EpF();e.TgZ(0,"app-history-grid",60),e.NdJ("select",function(o){return e.CHM(i),e.oxw().history.select(o,!0)}),e.qZA()}2&s&&e.Q6J("height",200)("context","apextest")}function le(s,r){1&s&&(e.TgZ(0,"p",66),e._uU(1,"* Providing Test Suite Name is Mandatory"),e.qZA())}function ce(s,r){if(1&s){const i=e.EpF();e.TgZ(0,"div",61),e.TgZ(1,"div",62),e.TgZ(2,"label",63),e.TgZ(3,"b"),e._uU(4,"Test Suite Name"),e.qZA(),e.qZA(),e.TgZ(5,"input",64),e.NdJ("ngModelChange",function(o){return e.CHM(i),e.oxw().UI.testSuiteName=o}),e.qZA(),e._UZ(6,"br"),e.YNc(7,le,2,0,"p",65),e.qZA(),e.qZA()}if(2&s){const i=e.oxw();e.xp6(5),e.Q6J("ngModel",i.UI.testSuiteName),e.xp6(2),e.Q6J("ngIf",i.UI.error)}}const de=[{path:"",component:(()=>{class s{constructor(i){this.Service=i,this.filterExpandSettings={expandMatches:!0},this.state={filter:{logic:"and",filters:[]}},this.utility={mapClassNameWithMethods:()=>{this.main.testClassMappedWithMethods=[];let t=[];this.main.apexTestClasses.forEach(o=>{var n;let d={};d.Name=o.Name,d.Methods=null===(n=o.SymbolTable)||void 0===n?void 0:n.methods.map(a=>{if(a.annotations.find(l=>"IsTest"==l.name)){let l={};return l.Name=a.name,l}}),d.Methods=d.Methods.filter(a=>null!=a),0!=d.Methods.length&&t.push(d)}),this.main.testClassMappedWithMethods=t.sort((o,n)=>o.Name.localeCompare(n.Name))},storeApexTestRunId:t=>{let o=localStorage.getItem("ApexTestRun"),n=o?JSON.parse(o):JSON.parse(`{ "${g.I8.orgId}" : {}}`);n.hasOwnProperty(g.I8.orgId)||(n[g.I8.orgId]={}),n[g.I8.orgId][t]=Date.now(),localStorage.setItem("ApexTestRun",JSON.stringify(n))},storeApexTestSelection:(t,o)=>{let n={};n.selection=Object.assign({},t),n.Name=o,this.history.record(n)},parseApexTestResult:(t,o)=>{t.forEach(c=>{c.AsyncApexJobId=c.AsyncApexJobId.substring(0,15),c.Timestamp=o[c.AsyncApexJobId]});let n=[];const d=[...new Set(t.map(c=>c.AsyncApexJobId))];d.forEach(c=>{const m=t.filter(T=>T.AsyncApexJobId==c);let h={Id:c,Name:c,Message:null,Outcome:null,Timestamp:o[c],ParentId:null};const _=m[0].ApexTestRunResult.MethodsEnqueued;h.QueueItem=_==m.length&&m.every(T=>{var b;return"Completed"==(null===(b=T.QueueItem)||void 0===b?void 0:b.Status)})?"Completed":"Processing";const x=parseInt((m.length/_*100||0).toFixed(0));h.Progress=100==x&&"Processing"==h.QueueItem?99:x,n.push(h)}),n.sort((c,m)=>m.Timestamp-c.Timestamp);let a=[...n],l={};d.forEach(c=>{let m=t.filter(h=>c==h.AsyncApexJobId);l[c]=[...new Set(m.map(h=>h.ApexClass.Name).sort((h,_)=>h.localeCompare(_)))]}),Object.keys(l).forEach(c=>{l[c].forEach(h=>{const _=t.find(T=>T.AsyncApexJobId==c&&T.ApexClass.Name==h);n.push({Id:_.ApexClassId+_.AsyncApexJobId,Name:_.ApexClass.Name,Message:null,Outcome:null,QueueItem:null,Timestamp:null,ParentId:c,Progress:null})})}),Object.keys(l).forEach(c=>{l[c].forEach(h=>{t.filter(x=>h==x.ApexClass.Name&&c==x.AsyncApexJobId).forEach((x,T)=>{n.push({Id:T,Name:x.MethodName,Message:x.Message,Outcome:x.Outcome,QueueItem:null,Timestamp:null,ParentId:x.ApexClassId+x.AsyncApexJobId,Progress:null})})})}),this.main.apexTestResults=n,this.Service.getnotification(a)}},this.UI={routes:["Apex Code Coverage","New Test Run","Test Execution Results","Apex Test History"],selectedRoute:"Apex Code Coverage",key:"Name",testSuiteName:"",error:!1,live:u.X.datatemp.tasks.poll.activeTest,checkedKeys:[],setlive:()=>{u.X.operation.tasks.poll.stopTest(),this.UI.live=!this.UI.live,this.Service.watchers.apextest=this.UI.live,u.X.datatemp.tasks.poll.activeTest=this.UI.live,this.UI.live&&(u.X.datatemp.tasks.poll.intervalTest=setInterval(this.main.getTestExecutionResult,1e4))},changeRoute:t=>{this.UI.selectedRoute=t,"New Test Run"==this.UI.selectedRoute?this.utility.mapClassNameWithMethods():"Test Execution Results"==this.UI.selectedRoute&&this.main.getTestExecutionResult(!0)},removeClass:t=>{delete this.main.checkedTestClass[t],this.UI.makeRevisedTreeView()},removeMethod:(t,o)=>{if("All Methods Selected"==this.main.checkedTestClass[t])delete this.main.checkedTestClass[t];else{const n=this.main.checkedTestClass[t].split(","),d=n.findIndex(a=>a==o);n.splice(d,1),this.main.checkedTestClass[t]=n.join(","),""==this.main.checkedTestClass[t]&&delete this.main.checkedTestClass[t]}this.UI.makeRevisedTreeView()},makeRevisedTreeView:()=>{this.UI.checkedKeys=[],Object.keys(this.main.checkedTestClass).forEach(t=>{if("All Methods Selected"==this.main.checkedTestClass[t]){const o=this.main.testClassMappedWithMethods.findIndex(d=>d.Name==t),n=this.main.testClassMappedWithMethods[o].Methods;this.UI.checkedKeys.push(`${o}`),n.forEach((d,a)=>this.UI.checkedKeys.push(`${o}_${a}`))}else this.main.checkedTestClass[t].split(",").forEach(n=>{const d=this.main.testClassMappedWithMethods.findIndex(l=>l.Name==t),a=this.main.testClassMappedWithMethods[d].Methods.findIndex(l=>l.Name==n);this.UI.checkedKeys.push(`${d}_${a}`)})})},reset:t=>{this.main.apexClass=[],this.main.apexTrigger=[],this.main.apexClassesAndTriggersCombined=[],this.main.apexCodeCoverage=[],this.main.apexTestClasses=[],this.main.testClassMappedWithMethods=[],this.main.checkedTestClass={},this.main.apexTestRunIds=[],this.main.init(t)},executeTest:t=>{Object.keys(this.main.checkedTestClass).length>0?C.y.ask({title:"Execute Test",callback:()=>{""!=this.UI.testSuiteName?(this.UI.error=!1,C.y.dialogprompt=null,this.utility.storeApexTestSelection(this.main.checkedTestClass,this.UI.testSuiteName),this.UI.executeTestBody(this.main.checkedTestClass)):this.UI.error=!0},template:t}):C.y.maketoast({template:"error",body:"Cannot Execute Test because No Test is Selected",duration:5e3})},executeTestBody:t=>{this.UI.testSuiteName=(null==t?void 0:t.Name)?null==t?void 0:t.Name:this.UI.testSuiteName,t=(null==t?void 0:t.selection)?null==t?void 0:t.selection:t,this.main.showGrid=!1,this.main.subs.add(this.Service.executeTestRequest(t,this.main.apexTestClasses,!1).subscribe(o=>{if(!o)return this.main.showGrid=!0,this.main.checkedTestClass={},this.UI.checkedKeys=[],void this.utility.mapClassNameWithMethods();u.X.operation.support.update_count({test_executed:!0}),this.utility.storeApexTestRunId(o),this.main.checkedTestClass={},this.UI.checkedKeys=[],C.y.maketoast({template:"success",body:`Test Executed Successfully with a Suite Name '${this.UI.testSuiteName}'.`,duration:5e3}),this.UI.testSuiteName="",this.UI.changeRoute("Test Execution Results"),this.utility.mapClassNameWithMethods(),this.main.showGrid=!0}))},clearTestRun:()=>{this.main.apexTestRunIds=[],this.main.apexTestResults=[];let t=JSON.parse(localStorage.getItem("ApexTestRun"));t&&t.hasOwnProperty(g.I8.orgId)&&(delete t[g.I8.orgId],Object.keys(t).length>0?localStorage.setItem("ApexTestRun",JSON.stringify(t)):localStorage.removeItem("ApexTestRun")),this.main.showGrid=!0,C.y.maketoast({template:"success",body:"Apex Test Jobs cleared from cache successfully!"})},clearSelection:()=>{this.main.checkedTestClass={},this.UI.checkedKeys=[]}},this.main={apexClass:[],apexTrigger:[],apexClassesAndTriggersCombined:[],apexCodeCoverage:[],apexTestClasses:[],testClassMappedWithMethods:[],checkedTestClass:{},apexTestRunIds:[],apexTestResults:[],subs:new w.w0,subs2:new w.w0,showGrid:!1,init:t=>{this.UI.selectedRoute="Apex Code Coverage",this.main.showGrid=!1,this.main.subs.add(this.Service.makeToolingCompositeRequest().subscribe(o=>{[this.main.apexClass,this.main.apexTrigger,this.main.apexCodeCoverage]=o.compositeResponse.map(a=>a.body.records);const n=[];this.main.apexClass.forEach(a=>{var l;(null===(l=a.SymbolTable)||void 0===l?void 0:l.tableDeclaration.annotations.find(c=>"IsTest"==c.name))?this.main.apexTestClasses.push(a):n.push(a)}),this.main.apexClassesAndTriggersCombined=[...n,...this.main.apexTrigger].sort((a,l)=>a.Name.localeCompare(l.Name));let d=[];this.main.apexClassesAndTriggersCombined.forEach(a=>{const l=this.main.apexCodeCoverage.find(c=>c.ApexClassOrTriggerId==a.Id);if(null!=l){const c=l.NumLinesCovered+l.NumLinesUncovered;a.CodeCoverage=parseInt((l.NumLinesCovered/c*100||0).toFixed(0)),a.Lines=l.NumLinesCovered+"/"+c,d.push(a)}}),this.main.apexClassesAndTriggersCombined=[...d],t&&(this.utility.mapClassNameWithMethods(),this.UI.makeRevisedTreeView()),this.main.showGrid=!0,this.history.load()}))},handleChecking:t=>{var o,n,d;let a=null===(o=t.parent)||void 0===o?void 0:o.item.dataItem.Name,l=t.item.dataItem.Name;if(null==t.parent)this.main.checkedTestClass.hasOwnProperty(a||l)&&"All Methods Selected"==this.main.checkedTestClass[a||l]?delete this.main.checkedTestClass[a||l]:this.main.checkedTestClass[a||l]="All Methods Selected";else{let c=(null===(n=this.main.checkedTestClass[a])||void 0===n?void 0:n.split(","))||[];"All Methods Selected"===this.main.checkedTestClass[a]&&(c=t.parent.item.dataItem.Methods.map(h=>h.Name)),c.includes(l)?c.splice(c.indexOf(l),1):c.push(l);let m=c.length==this.main.testClassMappedWithMethods[null===(d=t.parent)||void 0===d?void 0:d.item.index].Methods.length?"All Methods Selected":c.join(",");""===m?delete this.main.checkedTestClass[a]:this.main.checkedTestClass[a]=m}},getTestExecutionResult:t=>{var o;const n=null===(o=JSON.parse(localStorage.getItem("ApexTestRun")))||void 0===o?void 0:o[g.I8.orgId];if(n){const d=Object.keys(n);this.main.showGrid=!t,this.main.apexTestRunIds=d,this.main.subs2.add(this.Service.getresultsforwatcher(this.main.apexTestRunIds).subscribe(a=>{t&&C.y.maketoast({template:"SUCCESS",body:"Refreshed."}),a.length>0&&this.utility.parseApexTestResult(a,n),this.main.showGrid=!0}))}}},this.history={record:t=>{u.X.operation.history.add(JSON.stringify(t),"apextest")},load:()=>{const{datatemp:{history:{selected:t}}}=u.X;t&&"apextest"==t.context&&(this.history.select(t),u.X.datatemp.history.selected={history:null,context:null},C.y.maketoast({template:"Success",body:"Restored from history"}))},select:t=>{let o=JSON.parse(t.history);this.UI.executeTestBody(o)}}}ngOnInit(){this.main.init(!1)}ngOnDestroy(){this.main.subs.unsubscribe(),u.X.datatemp.history.selected={history:null,context:null}}}return s.\u0275fac=function(i){return new(i||s)(e.Y36(S))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-apex-test"]],decls:18,vars:5,consts:[[1,"tabbed-panel"],[1,"body"],[4,"ngIf"],["id","navbar",1,"nav-container"],["class","",3,"ngClass","click",4,"ngFor","ngForOf"],["testselection",""],["apexcodecoverage",""],["testexecutionhistory",""],["testselectionhistory",""],["temp",""],[4,"ngTemplateOutlet"],[1,"",3,"ngClass","click"],["class","d-flex overflow-hidden h-100 w-100",4,"ngIf"],["class","h-100",4,"ngIf"],[1,"d-flex","overflow-hidden","h-100","w-100"],[1,"d-flex","flex-column","flex-shrink-0","p-3","bg-clr2",2,"width","50vw"],["id","testselection",1,"overflow-auto",2,"height","85%"],["textField","Name","kendoTreeViewHierarchyBinding","","childrenField","Methods","kendoTreeViewExpandable","","kendoTreeViewCheckable","",3,"nodes","filterable","ngStyle","checkedKeys","expandOnFilter","checkedKeysChange","checkedChange"],[1,"d-flex","justify-content-center","p-1","z-0"],["id","executetest",1,"btn","btn-sm","btn","btn-secondary","ms-1","me-1","button","width",3,"click"],["id","clearselection",1,"btn","btn-sm","btn","btn-secondary","ms-1","me-1","button","width",3,"click"],["id","refreshtestclasses",1,"btn","btn-sm","btn","btn-secondary","ms-1","me-1","button","width",3,"click"],["id","testselectionresult",1,"w-100","p-1","scrollable-area-full-h","overflow-auto",2,"background-color","#545a5f"],["class","card m-1",4,"ngFor","ngForOf"],[1,"card","m-1"],[1,"card-header",2,"font-size","medium"],[1,"bi","bi-x-circle",2,"float","right",3,"click"],["class","list-group list-group-flush",4,"ngFor","ngForOf"],[1,"list-group","list-group-flush"],[1,"list-group-item",2,"font-size","small"],[1,"h-100"],[1,"d-flex","h-100"],[1,"w-100","text-center","my-auto","scale-2"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"],["id","testcodecoverage","sortable","true","class","text-small h-100-40","style","background-color: inherit !important",3,"kendoGridBinding","scrollable","filter","filterable",4,"ngIf"],["class","d-flex py-1",4,"ngIf"],["id","testcodecoverage","sortable","true",1,"text-small","h-100-40",2,"background-color","inherit !important",3,"kendoGridBinding","scrollable","filter","filterable"],["field","Name","width","300","title","ApexClassOrTrigger","filter","text",3,"editable"],["field","ApiVersion","title","Api Version","filter","numeric",3,"editable"],["field","Status","title","Status","filter","text",3,"editable"],["field","IsValid","title","IsValid","filter","boolean",3,"editable"],["field","LastModifiedBy.Name","filter","text","title","Last Modified By",3,"editable"],["field","CodeCoverage","filter","numeric","title","Code Coverage(%)",3,"editable"],["field","Lines","filter","text","title","Lines",3,"editable"],[1,"d-flex","py-1"],["title","Refresh Apex Code Coverage","id","refreshcodecoverage",1,"btn","btn-sm","btn-light","me-1","ms-1","mt-1","mb-1",3,"click"],[1,"bi","bi-arrow-clockwise"],["kendoTreeListExpandable","","idField","Id","parentIdField","ParentId","class","text-small h-100-40","style","background-color: inherit !important",3,"kendoTreeListFlatBinding","height","sortable",4,"ngIf"],["kendoTreeListExpandable","","idField","Id","parentIdField","ParentId",1,"text-small","h-100-40",2,"background-color","inherit !important",3,"kendoTreeListFlatBinding","height","sortable"],["field","Name","title","Test Run",3,"expandable","width"],["field","Message","title","Message",3,"width"],["field","QueueItem","title","Status",3,"width"],["field","Outcome","title","Outcome",3,"width"],["field","Progress","title","Progress(%)",3,"width"],["field","Timestamp","title","Enqueued Time","filter","text",3,"width","editable"],["kendoTreeListCellTemplate",""],["title","Refresh Apex Test Jobs","id","refreshapextestresults",1,"btn","btn-sm","btn-light","me-1","ms-1","mt-1","mb-1",3,"click"],["title","Clears Previous Test Jobs from Cache","id","clearbtn",1,"btn","btn-sm","btn-danger","me-1","ms-1","mt-1","mb-1",3,"click"],[1,"bi","bi-backspace"],["id","livebutton",1,"btn","btn-sm","btn-light","me-1","ms-1","mt-1","mb-1",3,"click"],[3,"height","context","select"],[2,"width","35vw"],[1,"card-body"],[1,"form-label"],["type","text","placeholder","Provide a suitable name for this Test Suite for future use.",1,"form-control",3,"ngModel","ngModelChange"],["style","color: red;","class","card-text",4,"ngIf"],[1,"card-text",2,"color","red"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.YNc(2,q,2,1,"span",2),e.YNc(3,Q,2,1,"span",2),e.YNc(4,G,2,1,"span",2),e.YNc(5,j,2,1,"span",2),e.qZA(),e.TgZ(6,"div",3),e.YNc(7,L,2,4,"div",4),e.qZA(),e.qZA(),e.YNc(8,V,2,2,"ng-template",null,5,e.W1O),e.YNc(10,ee,3,3,"ng-template",null,6,e.W1O),e.YNc(12,oe,3,3,"ng-template",null,7,e.W1O),e.YNc(14,ae,1,2,"ng-template",null,8,e.W1O),e.YNc(16,ce,8,2,"ng-template",null,9,e.W1O)),2&i&&(e.xp6(2),e.Q6J("ngIf","New Test Run"==t.UI.selectedRoute),e.xp6(1),e.Q6J("ngIf","Apex Code Coverage"==t.UI.selectedRoute),e.xp6(1),e.Q6J("ngIf","Test Execution Results"==t.UI.selectedRoute),e.xp6(1),e.Q6J("ngIf","Apex Test History"==t.UI.selectedRoute),e.xp6(2),e.Q6J("ngForOf",t.UI.routes))},directives:[f.O5,f.tP,f.sg,f.mk,v.kD,v.i9,v.fe,v.Uh,f.PC,I.MwP,I.HWw,I.bg4,A.$ow,A.N6L,A.T4,A.bg4,A.Ztq,R.n,y.Fj,y.JJ,y.On],pipes:[f.Nd,f.uU],styles:[".activeTab[_ngcontent-%COMP%]{background-color:#d0d1d3;color:#000!important}.dynamicHeight[_ngcontent-%COMP%]{min-height:calc(100% - 10px)}.width[_ngcontent-%COMP%]{width:180px}"]}),s})()}];let re=(()=>{class s{}return s.\u0275fac=function(i){return new(i||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[k.Bz.forChild(de)],k.Bz]}),s})();var pe=p(3985),me=p(2627);let he=(()=>{class s{}return s.\u0275fac=function(i){return new(i||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[f.ez,re,I.zE6,y.u5,pe.W,v.dZ,A.r84,me.m]]}),s})()}}]);