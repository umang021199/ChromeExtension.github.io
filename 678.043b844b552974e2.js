"use strict";(self.webpackChunksfsce=self.webpackChunksfsce||[]).push([[678],{2678:(j,p,i)=>{i.r(p),i.d(p,{CloneDashboardsModule:()=>V});var h=i(9808),f=i(1533),x=i(3911),D=i(6921),_=i(2463),u=i(4128),w=i(4004),g=i(7555),b=i(4999),e=i(5e3),k=i(520);let v=(()=>{class o{constructor(t){this.http=t,this.soql={dashboards:"Select Id, Title, DeveloperName, FolderName, CreatedDate, CreatedBy.Name, FolderId from Dashboard Order By Title",folders:"Select Id, Name from Folder Where Type='Dashboard' Order By Name"}}getAllData(){return(0,u.D)(Object.keys(this.soql).map(t=>this.http.get(b.I8.instanceUrl+`/services/data/v${g.X.data.salesforce.api.version}/query/?q=`+this.soql[t]).pipe((0,w.U)(n=>{if("dashboards"==t)return n.records.forEach(l=>{l.newName="",l.newFolder={Name:l.FolderName,Id:l.FolderId},l.Selected=!1,delete l.attributes,delete l.CreatedBy.attributes}),n.records;if("folders"==t){let l=[];return l.push({Id:b.I8.currentUserId,Name:"Private Dashboards"}),n.records.forEach(d=>{delete d.attributes,d.Name&&l.push(d)}),l}}))))}createClone(t){return(0,u.D)(Object.keys(t).map(a=>this.http.post(b.I8.instanceUrl+`/services/data/v${g.X.data.salesforce.api.version}/analytics/dashboards?cloneId=`+a,t[a])))}deleteDashboards(t){return(0,u.D)(t.map(a=>this.http.delete(b.I8.instanceUrl+`/services/data/v${g.X.data.salesforce.api.version}/analytics/dashboards/`+a)))}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(k.eN))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var m=i(3075),c=i(2897),C=i(321);const I=["table"];function N(o,s){1&o&&e.GkF(0)}const T=function(o){return{activeTab:o}};function y(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",6),e.NdJ("click",function(){const l=e.CHM(t).$implicit;return e.oxw().UI.changeRoute(l)}),e._uU(1),e.qZA()}if(2&o){const t=s.$implicit,a=e.oxw();e.s9C("id","Clone Dashboards"==t?"clonedashboards":"deletedashboards"),e.Q6J("ngClass",e.VKq(3,T,t==a.UI.selectedRoute)),e.xp6(1),e.hij(" ",t," ")}}function U(o,s){1&o&&(e.TgZ(0,"div",23),e._UZ(1,"input",24),e.qZA(),e.TgZ(2,"div",25),e._uU(3,"Select All"),e.qZA())}function F(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"input",29),e.NdJ("ngModelChange",function(n){return e.CHM(t),e.oxw().$implicit.newName=n}),e.qZA()}if(2&o){const t=e.oxw().$implicit;e.Q6J("ngModel",t.newName)}}function Z(o,s){1&o&&e.YNc(0,F,1,1,"input",28),2&o&&e.Q6J("ngIf",s.$implicit.Selected)}function S(o,s){1&o&&(e.TgZ(0,"kendo-grid-column",26),e.YNc(1,Z,1,1,"ng-template",27),e.qZA()),2&o&&e.Q6J("filterable",!1)("editable",!1)("width",350)}function M(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"kendo-dropdownlist",31),e.NdJ("ngModelChange",function(n){return e.CHM(t).$implicit.newFolder=n})("valueChange",function(n){const d=e.CHM(t).rowIndex;return e.oxw(4).UI.dropdownValueChange(n,d)}),e.qZA()}if(2&o){const t=s.$implicit,a=e.oxw(4);e.Q6J("data",a.main.folders)("disabled",!t.Selected)("ngModel",t.newFolder)}}function J(o,s){1&o&&(e.TgZ(0,"kendo-grid-column",30),e.YNc(1,M,1,3,"ng-template",27),e.qZA()),2&o&&e.Q6J("filterable",!1)("editable",!1)("width",250)}const B=function(){return{checkboxOnly:!0,mode:"multiple"}};function A(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"kendo-grid",13,14),e.NdJ("selectionChange",function(n){return e.CHM(t),e.oxw(2).main.selectRow(n)})("cellClick",function(n){return e.CHM(t),e.oxw(2).cellClickHandler(n)})("cellClose",function(n){return e.CHM(t),e.oxw(2).cellCloseHandler(n)}),e.TgZ(2,"kendo-grid-checkbox-column",15),e.YNc(3,U,4,0,"ng-template",16),e.qZA(),e._UZ(4,"kendo-grid-column",17),e._UZ(5,"kendo-grid-column",18),e._UZ(6,"kendo-grid-column",19),e._UZ(7,"kendo-grid-column",20),e.YNc(8,S,2,3,"kendo-grid-column",21),e.YNc(9,J,2,3,"kendo-grid-column",22),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("kendoGridBinding",t.main.dashboards)("scrollable",!0)("selectable",e.DdM(14,B))("rowSelected",t.main.grid.rowselected)("filter",t.state.filter)("navigable",!0)("filterable",!0),e.xp6(2),e.Q6J("width",100),e.xp6(2),e.Q6J("editable",!1),e.xp6(1),e.Q6J("editable",!1),e.xp6(1),e.Q6J("editable",!1),e.xp6(1),e.Q6J("editable",!1),e.xp6(1),e.Q6J("ngIf","Clone Dashboards"==t.UI.selectedRoute),e.xp6(1),e.Q6J("ngIf","Clone Dashboards"==t.UI.selectedRoute)}}function G(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",32),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).main.init()}),e._uU(1," Refresh "),e._UZ(2,"i",33),e.qZA()}}function Q(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",34),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).main.createClone()}),e._uU(1," Clone Dashboards "),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("disabled",t.UI.disableButton)}}function O(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",35),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).main.popupForDelete()}),e._uU(1," Delete Dashboards "),e._UZ(2,"i",36),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("disabled",t.UI.disableButton)}}function R(o,s){if(1&o&&(e.TgZ(0,"span",37),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.UI.selectedDashboards>0?t.UI.selectedDashboards+" / "+t.main.dashboards.length+" Dashboards Selected":""," ")}}function E(o,s){if(1&o&&(e.YNc(0,A,10,15,"kendo-grid",7),e.TgZ(1,"div",8),e.YNc(2,G,3,0,"button",9),e.YNc(3,Q,2,1,"button",10),e.YNc(4,O,3,1,"button",11),e.YNc(5,R,2,1,"span",12),e.qZA()),2&o){const t=e.oxw();e.Q6J("ngIf",t.main.showGrid),e.xp6(2),e.Q6J("ngIf",t.main.showGrid),e.xp6(1),e.Q6J("ngIf",t.main.showGrid&&"Clone Dashboards"==t.UI.selectedRoute),e.xp6(1),e.Q6J("ngIf",t.main.showGrid&&"Delete Dashboards"==t.UI.selectedRoute),e.xp6(1),e.Q6J("ngIf",t.main.showGrid)}}const H=[{path:"",component:(()=>{class o{constructor(t,a){this.Service=t,this.formBuilder=a,this.state={filter:{logic:"and",filters:[]}},this.main={showGrid:!1,subs:new D.w0,dashboards:[],folders:[],grid:{rowselected:n=>n.dataItem.Selected},init:()=>{this.state={filter:{logic:"and",filters:[]}},this.main.subs.add(this.Service.getAllData().subscribe(n=>{n.length>0?(this.main.dashboards=n[0],this.main.folders=n[1],this.UI.showToast("SUCCESS",this.main.dashboards.length+" Dashboards Fetched.",500)):0==n[0].length&&this.UI.showToast("WARNING","No Dashboards found in this Org.",5e3),this.main.showGrid=!0,this.UI.checkButtonVisibltiy()}))},createClone:()=>{const n=this.main.dashboards.filter(r=>r.Selected);let l={},d=!0;n.forEach(r=>{""==r.newName.trim()?(this.UI.showToast("WARNING",`Cloned Dashboard Name of Dashboard - ( ${r.Title} ) can't be empty`,5e3),d=!1):(l[r.Id]={name:r.newName},r.newFolder.hasOwnProperty("Id")&&(l[r.Id].folderId=r.newFolder.Id))}),d&&this.main.subs.add(this.Service.createClone(l).subscribe(r=>{this.main.showGrid=!1,this.UI.showToast("SUCCESS",`${r.length} out of ${n.length} Dashboards Cloned Successfully`,5e3),this.main.init()}))},selectRow:n=>{(n.selectedRows.length>0?n.selectedRows:n.deselectedRows).forEach(d=>{d.dataItem.Selected=!d.dataItem.Selected,d.dataItem.newName=n.selectedRows.length>0?("Copy of "+d.dataItem.Title).substring(0,40):""}),this.UI.checkButtonVisibltiy()},popupForDelete:()=>{_.y.ask({question:"Are you sure you want to Delete these Dashboards?",callback:()=>{_.y.dialogprompt=null,this.main.deleteDashboards()}})},deleteDashboards:()=>{const n=[];this.main.dashboards.forEach(l=>{l.Selected&&n.push(l.Id)}),this.main.subs.add(this.Service.deleteDashboards(n).subscribe(l=>{this.main.showGrid=!1,this.UI.showToast("SUCCESS",`${l.length} out of ${n.length} Dashboards Deleted Successfully`,5e3),this.main.init()}))}},this.UI={routes:["Clone Dashboards","Delete Dashboards"],selectedRoute:"Clone Dashboards",disableButton:!0,selectedDashboards:0,changeRoute:n=>{this.UI.selectedRoute=n,this.state={filter:{logic:"and",filters:[]}},this.main.dashboards.forEach(l=>{l.Selected=!1,l.newName=""})},checkButtonVisibltiy:()=>{let n=this.main.dashboards.filter(l=>l.Selected).length;this.UI.selectedDashboards=n,this.UI.disableButton=!(n>0)},dropdownValueChange:(n,l)=>{this.main.dashboards[l].newFolder=Object.assign({},n)},showToast:(n,l,d)=>{_.y.maketoast({template:n,body:l,duration:d})}}}ngOnInit(){this.main.init()}ngOnDestroy(){this.main.subs.unsubscribe(),_.y.clearAsk()}cellClickHandler(t){!t.isEdited&&6!=t.columnIndex&&t.sender.editCell(t.rowIndex,t.columnIndex,this.createFormGroup(t.dataItem))}cellCloseHandler(t){this.UI.checkButtonVisibltiy();const{formGroup:a,dataItem:n}=t;if(null==a?void 0:a.valid){if(a.dirty){if(t.originalEvent&&t.originalEvent.keyCode===x.R8.Escape)return;Object.assign(n,a.value)}}else t.preventDefault()}createFormGroup(t){let a=this.main.dashboards.findIndex(({Id:n})=>n===t.Id);return this.main.dashboards[a].Selected=!0,""==this.main.dashboards[a].newName.trim()?(this.main.dashboards[a].newName=("Copy of "+t.Title).substring(0,40),this.UI.checkButtonVisibltiy(),this.formBuilder.group({Id:t.Id,Title:t.DeveloperName,DeveloperName:t.DeveloperName,FolderName:t.FolderName,CreatedBy:{Name:t.CreatedBy.Name},newName:("Copy of "+t.Title).substring(0,40)})):(this.UI.checkButtonVisibltiy(),this.formBuilder.group({Id:t.Id,Title:t.DeveloperName,DeveloperName:t.DeveloperName,FolderName:t.FolderName,CreatedBy:{Name:t.CreatedBy.Name},newName:this.main.dashboards[a].newName}))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(v),e.Y36(m.qu))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-clone-dashboards"]],viewQuery:function(t,a){if(1&t&&e.Gf(I,5),2&t){let n;e.iGM(n=e.CRH())&&(a.grid=n.first)}},decls:7,vars:2,consts:[[1,"tabbed-panel"],[1,"body"],[4,"ngTemplateOutlet"],["id","navbar",1,"nav-container"],["class","",3,"id","ngClass","click",4,"ngFor","ngForOf"],["grid",""],[1,"",3,"id","ngClass","click"],["id","dashboardsgrid","sortable","true","class","text-small h-100-40","style","background-color: inherit !important",3,"kendoGridBinding","scrollable","selectable","rowSelected","filter","navigable","filterable","selectionChange","cellClick","cellClose",4,"ngIf"],[1,"d-flex"],["id","refreshbtn","class","btn btn-sm btn-light me-1 ms-2 mt-2 mb-1",3,"click",4,"ngIf"],["class","btn btn-sm btn-danger me-1 ms-1 mt-2 mb-1","id","clonebtn",3,"disabled","click",4,"ngIf"],["class","btn btn-sm btn-danger me-1 ms-1 mt-2 mb-1","id","deletebtn",3,"disabled","click",4,"ngIf"],["class","text-center me-2 ms-1 mt-3 ms-auto","style","font-size: 0.9rem ",4,"ngIf"],["id","dashboardsgrid","sortable","true",1,"text-small","h-100-40",2,"background-color","inherit !important",3,"kendoGridBinding","scrollable","selectable","rowSelected","filter","navigable","filterable","selectionChange","cellClick","cellClose"],["table",""],["showSelectAll","true",3,"width"],["kendoGridHeaderTemplate",""],["field","Title","title","Name",3,"editable"],["field","DeveloperName","title","Unique Name",3,"editable"],["field","FolderName","title","Folder",3,"editable"],["field","CreatedBy.Name","title","Created By",3,"editable"],["title","Cloned Dashboard Name","field","newName",3,"filterable","editable","width",4,"ngIf"],["title","New Folder","field","newFolder",3,"filterable","editable","width",4,"ngIf"],[1,"inline-div"],["kendoGridSelectAllCheckbox","","type","checkbox","id","headerCheckbox",1,"k-checkbox"],[1,"inline-div",2,"padding-left","0.5vw"],["title","Cloned Dashboard Name","field","newName",3,"filterable","editable","width"],["kendoGridCellTemplate",""],["type","text","class","form-control form-control-sm form-control-focus","maxlength","40",3,"ngModel","ngModelChange",4,"ngIf"],["type","text","maxlength","40",1,"form-control","form-control-sm","form-control-focus",3,"ngModel","ngModelChange"],["title","New Folder","field","newFolder",3,"filterable","editable","width"],["textField","Name","valueField","Id",3,"data","disabled","ngModel","ngModelChange","valueChange"],["id","refreshbtn",1,"btn","btn-sm","btn-light","me-1","ms-2","mt-2","mb-1",3,"click"],[1,"bi","bi-arrow-clockwise"],["id","clonebtn",1,"btn","btn-sm","btn-danger","me-1","ms-1","mt-2","mb-1",3,"disabled","click"],["id","deletebtn",1,"btn","btn-sm","btn-danger","me-1","ms-1","mt-2","mb-1",3,"disabled","click"],[1,"bi","bi-trash"],[1,"text-center","me-2","ms-1","mt-3","ms-auto",2,"font-size","0.9rem"]],template:function(t,a){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.YNc(2,N,1,0,"ng-container",2),e.qZA(),e.TgZ(3,"div",3),e.YNc(4,y,2,5,"div",4),e.qZA(),e.qZA(),e.YNc(5,E,6,5,"ng-template",null,5,e.W1O)),2&t){const n=e.MAs(6);e.xp6(2),e.Q6J("ngTemplateOutlet",n),e.xp6(2),e.Q6J("ngForOf",a.UI.routes)}},directives:[h.tP,h.sg,h.mk,h.O5,c.MwP,c.HWw,c.HbC,c._cx,c.Gtk,c.bg4,c.Ztq,m.Fj,m.nD,m.JJ,m.On,C.rI],styles:[".activeTab[_ngcontent-%COMP%]{background-color:#d0d1d3;color:#000!important}.inline-div[_ngcontent-%COMP%]{display:inline-block}.k-checkbox[_ngcontent-%COMP%]:checked{border-color:#6495ed!important;background-color:#6495ed!important}.k-checkbox[_ngcontent-%COMP%]:indeterminate{color:#6495ed!important}.form-control-focus[_ngcontent-%COMP%]{border-color:#6495ed;box-shadow:0 0 0 .2rem #2885f640}#headerCheckbox[_ngcontent-%COMP%]{width:16px;height:16px;border-radius:4px}"]}),o})()}];let Y=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[f.Bz.forChild(H)],f.Bz]}),o})();var $=i(9446),P=i(1375),q=i(3985);let V=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[h.ez,Y,c.zE6,C.q2,m.u5,$.rw,m.UX,P.cP,q.W]]}),o})()}}]);